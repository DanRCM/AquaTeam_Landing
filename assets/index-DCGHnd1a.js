(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var e=()=>void 0,t=function(e){let t=[],n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)==55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)==56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},n=function(e){let t=[],n=0,r=0;for(;n<e.length;){let i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){let a=e[n++];t[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){let a=e[n++],o=e[n++],s=e[n++],c=((i&7)<<18|(a&63)<<12|(o&63)<<6|s&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{let a=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return t.join(``)},r={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789`,get ENCODED_VALS(){return this.ENCODED_VALS_BASE+`+/=`},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+`-_.`},HAS_NATIVE_SUPPORT:typeof atob==`function`,encodeByteArray(e,t){if(!Array.isArray(e))throw Error(`encodeByteArray takes an array as a parameter`);this.init_();let n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){let i=e[t],a=t+1<e.length,o=a?e[t+1]:0,s=t+2<e.length,c=s?e[t+2]:0,l=i>>2,u=(i&3)<<4|o>>4,d=(o&15)<<2|c>>6,f=c&63;s||(f=64,a||(d=64)),r.push(n[l],n[u],n[d],n[f])}return r.join(``)},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):n(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){let a=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;let s=t<e.length?n[e.charAt(t)]:64;++t;let c=t<e.length?n[e.charAt(t)]:64;if(++t,a==null||o==null||s==null||c==null)throw new i;let l=a<<2|o>>4;if(r.push(l),s!==64){let e=o<<4&240|s>>2;if(r.push(e),c!==64){let e=s<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},i=class extends Error{constructor(){super(...arguments),this.name=`DecodeBase64StringError`}},a=function(e){let n=t(e);return r.encodeByteArray(n,!0)},o=function(e){return a(e).replace(/\./g,``)},s=function(e){try{return r.decodeString(e,!0)}catch(e){console.error(`base64Decode failed: `,e)}return null};function c(){if(typeof self<`u`)return self;if(typeof window<`u`)return window;if(typeof global<`u`)return global;throw Error(`Unable to locate global object.`)}var l=()=>c().__FIREBASE_DEFAULTS__,u=()=>{if(typeof process>`u`)return;let e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},d=()=>{if(typeof document>`u`)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let t=e&&s(e[1]);return t&&JSON.parse(t)},f=()=>{try{return e()||l()||u()||d()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},p=e=>f()?.emulatorHosts?.[e],m=e=>{let t=p(e);if(!t)return;let n=t.lastIndexOf(`:`);if(n<=0||n+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let r=parseInt(t.substring(n+1),10);return t[0]===`[`?[t.substring(1,n-1),r]:[t.substring(0,n),r]},h=()=>f()?.config,g=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e==`function`&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}};function ee(e){try{return(e.startsWith(`http://`)||e.startsWith(`https://`)?new URL(e).hostname:e).endsWith(`.cloudworkstations.dev`)}catch{return!1}}async function te(e){return(await fetch(e,{credentials:`include`})).ok}function ne(e,t){if(e.uid)throw Error(`The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.`);let n={alg:`none`,type:`JWT`},r=t||`demo-project`,i=e.iat||0,a=e.sub||e.user_id;if(!a)throw Error(`mockUserToken must contain 'sub' or 'user_id' field!`);let s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:`custom`,identities:{}},...e};return[o(JSON.stringify(n)),o(JSON.stringify(s)),``].join(`.`)}var re={};function ie(){let e={prod:[],emulator:[]};for(let t of Object.keys(re))re[t]?e.emulator.push(t):e.prod.push(t);return e}function _(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement(`div`),t.setAttribute(`id`,e),n=!0),{created:n,element:t}}var ae=!1;function oe(e,t){if(typeof window>`u`||typeof document>`u`||!ee(window.location.host)||re[e]===t||re[e]||ae)return;re[e]=t;function n(e){return`__firebase__banner__${e}`}let r=`__firebase__banner`,i=ie().prod.length>0;function a(){let e=document.getElementById(r);e&&e.remove()}function o(e){e.style.display=`flex`,e.style.background=`#7faaf0`,e.style.position=`fixed`,e.style.bottom=`5px`,e.style.left=`5px`,e.style.padding=`.5em`,e.style.borderRadius=`5px`,e.style.alignItems=`center`}function s(e,t){e.setAttribute(`width`,`24`),e.setAttribute(`id`,t),e.setAttribute(`height`,`24`),e.setAttribute(`viewBox`,`0 0 24 24`),e.setAttribute(`fill`,`none`),e.style.marginLeft=`-6px`}function c(){let e=document.createElement(`span`);return e.style.cursor=`pointer`,e.style.marginLeft=`16px`,e.style.fontSize=`24px`,e.innerHTML=` &times;`,e.onclick=()=>{ae=!0,a()},e}function l(e,t){e.setAttribute(`id`,t),e.innerText=`Learn more`,e.href=`https://firebase.google.com/docs/studio/preview-apps#preview-backend`,e.setAttribute(`target`,`__blank`),e.style.paddingLeft=`5px`,e.style.textDecoration=`underline`}function u(){let e=_(r),t=n(`text`),a=document.getElementById(t)||document.createElement(`span`),u=n(`learnmore`),d=document.getElementById(u)||document.createElement(`a`),f=n(`preprendIcon`),p=document.getElementById(f)||document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);if(e.created){let t=e.element;o(t),l(d,u);let n=c();s(p,f),t.append(p,a,d,n),document.body.appendChild(t)}i?(a.innerText=`Preview backend disconnected.`,p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,a.innerText=`Preview backend running in this workspace.`),a.setAttribute(`id`,t)}document.readyState===`loading`?window.addEventListener(`DOMContentLoaded`,u):u()}function se(){return typeof navigator<`u`&&typeof navigator.userAgent==`string`?navigator.userAgent:``}function v(){let e=f()?.forceEnvironment;if(e===`node`)return!0;if(e===`browser`)return!1;try{return Object.prototype.toString.call(global.process)===`[object process]`}catch{return!1}}function y(){return!v()&&!!navigator.userAgent&&navigator.userAgent.includes(`Safari`)&&!navigator.userAgent.includes(`Chrome`)}function ce(){try{return typeof indexedDB==`object`}catch{return!1}}function le(){return new Promise((e,t)=>{try{let n=!0,r=`validate-browser-context-for-indexeddb-analytics-module`,i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{t(i.error?.message||``)}}catch(e){t(e)}})}var ue=`FirebaseError`,de=class e extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=ue,Object.setPrototypeOf(this,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fe.prototype.create)}},fe=class{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){let n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],a=i?pe(i,n):`Error`;return new de(r,`${this.serviceName}: ${a} (${r}).`,n)}};function pe(e,t){return e.replace(me,(e,n)=>{let r=t[n];return r==null?`<${n}?>`:String(r)})}var me=/\{\$([^}]+)}/g;function he(e,t){if(e===t)return!0;let n=Object.keys(e),r=Object.keys(t);for(let i of n){if(!r.includes(i))return!1;let n=e[i],a=t[i];if(ge(n)&&ge(a)){if(!he(n,a))return!1}else if(n!==a)return!1}for(let e of r)if(!n.includes(e))return!1;return!0}function ge(e){return typeof e==`object`&&!!e}function _e(e){return e&&e._delegate?e._delegate:e}var ve=class{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode=`LAZY`,this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}},ye=`[DEFAULT]`,be=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new g;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(n)return null;throw e}else if(n)return null;else throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(Se(e))try{this.getOrInitializeService({instanceIdentifier:ye})}catch{}for(let[e,t]of this.instancesDeferred.entries()){let n=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch{}}}}clearInstance(e=ye){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>`INTERNAL`in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>`_delete`in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ye){return this.instances.has(e)}getOptions(e=ye){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(let[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){let n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);let i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let n=this.onInitCallbacks.get(t);if(n)for(let r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:xe(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ye){return this.component?this.component.multipleInstances?e:ye:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!==`EXPLICIT`}};function xe(e){return e===ye?void 0:e}function Se(e){return e.instantiationMode===`EAGER`}var Ce=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new be(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}},we=[],b;(function(e){e[e.DEBUG=0]=`DEBUG`,e[e.VERBOSE=1]=`VERBOSE`,e[e.INFO=2]=`INFO`,e[e.WARN=3]=`WARN`,e[e.ERROR=4]=`ERROR`,e[e.SILENT=5]=`SILENT`})(b||={});var Te={debug:b.DEBUG,verbose:b.VERBOSE,info:b.INFO,warn:b.WARN,error:b.ERROR,silent:b.SILENT},Ee=b.INFO,De={[b.DEBUG]:`log`,[b.VERBOSE]:`log`,[b.INFO]:`info`,[b.WARN]:`warn`,[b.ERROR]:`error`},Oe=(e,t,...n)=>{if(t<e.logLevel)return;let r=new Date().toISOString(),i=De[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)},ke=class{constructor(e){this.name=e,this._logLevel=Ee,this._logHandler=Oe,this._userLogHandler=null,we.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in b))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e==`string`?Te[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!=`function`)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,b.DEBUG,...e),this._logHandler(this,b.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,b.VERBOSE,...e),this._logHandler(this,b.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,b.INFO,...e),this._logHandler(this,b.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,b.WARN,...e),this._logHandler(this,b.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,b.ERROR,...e),this._logHandler(this,b.ERROR,...e)}},Ae=(e,t)=>t.some(t=>e instanceof t),je,Me;function Ne(){return je||=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]}function Pe(){return Me||=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]}var x=new WeakMap,S=new WeakMap,Fe=new WeakMap,Ie=new WeakMap,Le=new WeakMap;function Re(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener(`success`,i),e.removeEventListener(`error`,a)},i=()=>{t(We(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener(`success`,i),e.addEventListener(`error`,a)});return t.then(t=>{t instanceof IDBCursor&&x.set(t,e)}).catch(()=>{}),Le.set(t,e),t}function ze(e){if(S.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener(`complete`,i),e.removeEventListener(`error`,a),e.removeEventListener(`abort`,a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException(`AbortError`,`AbortError`)),r()};e.addEventListener(`complete`,i),e.addEventListener(`error`,a),e.addEventListener(`abort`,a)});S.set(e,t)}var Be={get(e,t,n){if(e instanceof IDBTransaction){if(t===`done`)return S.get(e);if(t===`objectStoreNames`)return e.objectStoreNames||Fe.get(e);if(t===`store`)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return We(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t===`done`||t===`store`)?!0:t in e}};function Ve(e){Be=e(Be)}function He(e){return e===IDBDatabase.prototype.transaction&&!(`objectStoreNames`in IDBTransaction.prototype)?function(t,...n){let r=e.call(Ge(this),t,...n);return Fe.set(r,t.sort?t.sort():[t]),We(r)}:Pe().includes(e)?function(...t){return e.apply(Ge(this),t),We(x.get(this))}:function(...t){return We(e.apply(Ge(this),t))}}function Ue(e){return typeof e==`function`?He(e):(e instanceof IDBTransaction&&ze(e),Ae(e,Ne())?new Proxy(e,Be):e)}function We(e){if(e instanceof IDBRequest)return Re(e);if(Ie.has(e))return Ie.get(e);let t=Ue(e);return t!==e&&(Ie.set(e,t),Le.set(t,e)),t}var Ge=e=>Le.get(e);function Ke(e,t,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){let o=indexedDB.open(e,t),s=We(o);return r&&o.addEventListener(`upgradeneeded`,e=>{r(We(o.result),e.oldVersion,e.newVersion,We(o.transaction),e)}),n&&o.addEventListener(`blocked`,e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{a&&e.addEventListener(`close`,()=>a()),i&&e.addEventListener(`versionchange`,e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}var qe=[`get`,`getKey`,`getAll`,`getAllKeys`,`count`],Je=[`put`,`add`,`delete`,`clear`],Ye=new Map;function Xe(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t==`string`))return;if(Ye.get(t))return Ye.get(t);let n=t.replace(/FromIndex$/,``),r=t!==n,i=Je.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||qe.includes(n)))return;let a=async function(e,...t){let a=this.transaction(e,i?`readwrite`:`readonly`),o=a.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&a.done]))[0]};return Ye.set(t,a),a}Ve(e=>({...e,get:(t,n,r)=>Xe(t,n)||e.get(t,n,r),has:(t,n)=>!!Xe(t,n)||e.has(t,n)}));var Ze=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(Qe(e)){let t=e.getImmediate();return`${t.library}/${t.version}`}else return null}).filter(e=>e).join(` `)}};function Qe(e){return e.getComponent()?.type===`VERSION`}var $e=`@firebase/app`,et=`0.14.6`,C=new ke(`@firebase/app`),w=`@firebase/app-compat`,tt=`@firebase/analytics-compat`,nt=`@firebase/analytics`,rt=`@firebase/app-check-compat`,it=`@firebase/app-check`,at=`@firebase/auth`,ot=`@firebase/auth-compat`,st=`@firebase/database`,ct=`@firebase/data-connect`,lt=`@firebase/database-compat`,ut=`@firebase/functions`,dt=`@firebase/functions-compat`,ft=`@firebase/installations`,pt=`@firebase/installations-compat`,mt=`@firebase/messaging`,ht=`@firebase/messaging-compat`,gt=`@firebase/performance`,_t=`@firebase/performance-compat`,vt=`@firebase/remote-config`,yt=`@firebase/remote-config-compat`,bt=`@firebase/storage`,xt=`@firebase/storage-compat`,St=`@firebase/firestore`,Ct=`@firebase/ai`,wt=`@firebase/firestore-compat`,Tt=`firebase`,Et=`12.6.0`,Dt=`[DEFAULT]`,Ot={[$e]:`fire-core`,[w]:`fire-core-compat`,[nt]:`fire-analytics`,[tt]:`fire-analytics-compat`,[it]:`fire-app-check`,[rt]:`fire-app-check-compat`,[at]:`fire-auth`,[ot]:`fire-auth-compat`,[st]:`fire-rtdb`,[ct]:`fire-data-connect`,[lt]:`fire-rtdb-compat`,[ut]:`fire-fn`,[dt]:`fire-fn-compat`,[ft]:`fire-iid`,[pt]:`fire-iid-compat`,[mt]:`fire-fcm`,[ht]:`fire-fcm-compat`,[gt]:`fire-perf`,[_t]:`fire-perf-compat`,[vt]:`fire-rc`,[yt]:`fire-rc-compat`,[bt]:`fire-gcs`,[xt]:`fire-gcs-compat`,[St]:`fire-fst`,[wt]:`fire-fst-compat`,[Ct]:`fire-vertex`,"fire-js":`fire-js`,[Tt]:`fire-js-all`},kt=new Map,At=new Map,jt=new Map;function Mt(e,t){try{e.container.addComponent(t)}catch(n){C.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Nt(e){let t=e.name;if(jt.has(t))return C.debug(`There were multiple attempts to register component ${t}.`),!1;jt.set(t,e);for(let t of kt.values())Mt(t,e);for(let t of At.values())Mt(t,e);return!0}function Pt(e,t){let n=e.container.getProvider(`heartbeat`).getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ft(e){return e==null?!1:e.settings!==void 0}var It=new fe(`app`,`Firebase`,{"no-app":`No Firebase App '{$appName}' has been created - call initializeApp() first`,"bad-app-name":`Illegal App name: '{$appName}'`,"duplicate-app":`Firebase App named '{$appName}' already exists with different options or config`,"app-deleted":`Firebase App named '{$appName}' already deleted`,"server-app-deleted":`Firebase Server App has been deleted`,"no-options":`Need to provide options, when not being deployed to hosting via source.`,"invalid-app-argument":`firebase.{$appName}() takes either no argument or a Firebase App instance.`,"invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":`Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.`,"idb-get":`Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.`,"idb-set":`Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.`,"idb-delete":`Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.`,"finalization-registry-not-supported":`FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.`,"invalid-server-app-environment":`FirebaseServerApp is not for use in browser environments.`}),Lt=class{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ve(`app`,()=>this,`PUBLIC`))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw It.create(`app-deleted`,{appName:this._name})}},Rt=Et;function zt(e,t={}){let n=e;typeof t!=`object`&&(t={name:t});let r={name:Dt,automaticDataCollectionEnabled:!0,...t},i=r.name;if(typeof i!=`string`||!i)throw It.create(`bad-app-name`,{appName:String(i)});if(n||=h(),!n)throw It.create(`no-options`);let a=kt.get(i);if(a){if(he(n,a.options)&&he(r,a.config))return a;throw It.create(`duplicate-app`,{appName:i})}let o=new Ce(i);for(let e of jt.values())o.addComponent(e);let s=new Lt(n,r,o);return kt.set(i,s),s}function Bt(e=Dt){let t=kt.get(e);if(!t&&e===`[DEFAULT]`&&h())return zt();if(!t)throw It.create(`no-app`,{appName:e});return t}function T(e,t,n){let r=Ot[e]??e;n&&(r+=`-${n}`);let i=r.match(/\s|\//),a=t.match(/\s|\//);if(i||a){let e=[`Unable to register library "${r}" with version "${t}":`];i&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&e.push(`and`),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),C.warn(e.join(` `));return}Nt(new ve(`${r}-version`,()=>({library:r,version:t}),`VERSION`))}var Vt=`firebase-heartbeat-database`,Ht=1,Ut=`firebase-heartbeat-store`,E=null;function Wt(){return E||=Ke(Vt,Ht,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Ut)}catch(e){console.warn(e)}}}}).catch(e=>{throw It.create(`idb-open`,{originalErrorMessage:e.message})}),E}async function Gt(e){try{let t=(await Wt()).transaction(Ut),n=await t.objectStore(Ut).get(qt(e));return await t.done,n}catch(e){if(e instanceof de)C.warn(e.message);else{let t=It.create(`idb-get`,{originalErrorMessage:e?.message});C.warn(t.message)}}}async function Kt(e,t){try{let n=(await Wt()).transaction(Ut,`readwrite`);await n.objectStore(Ut).put(t,qt(e)),await n.done}catch(e){if(e instanceof de)C.warn(e.message);else{let t=It.create(`idb-set`,{originalErrorMessage:e?.message});C.warn(t.message)}}}function qt(e){return`${e.name}!${e.options.appId}`}var Jt=1024,Yt=30,Xt=class{constructor(e){this.container=e,this._heartbeatsCache=null,this._storage=new $t(this.container.getProvider(`app`).getImmediate()),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider(`platform-logger`).getImmediate().getPlatformInfoString(),t=Zt();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>Yt){let e=tn(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){C.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return``;let e=Zt(),{heartbeatsToSend:t,unsentEntries:n}=Qt(this._heartbeatsCache.heartbeats),r=o(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return C.warn(e),``}}};function Zt(){return new Date().toISOString().substring(0,10)}function Qt(e,t=Jt){let n=[],r=e.slice();for(let i of e){let e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),en(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),en(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var $t=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ce()?le().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let e=await Gt(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return Kt(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return Kt(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}else return}};function en(e){return o(JSON.stringify({version:2,heartbeats:e})).length}function tn(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}function nn(e){Nt(new ve(`platform-logger`,e=>new Ze(e),`PRIVATE`)),Nt(new ve(`heartbeat`,e=>new Xt(e),`PRIVATE`)),T($e,et,e),T($e,et,`esm2020`),T(`fire-js`,``)}nn(``),T(`firebase`,`12.6.0`,`app`);var rn=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},an={},on;(function(){var e;function t(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(e,t,n){n||=0;let r=Array(16);if(typeof t==`string`)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let a=e.g[3],o;o=t+(a^n&(i^a))+r[0]+3614090360&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[1]+3905402710&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[2]+606105819&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[4]+4118548399&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[5]+1200080426&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[6]+2821735955&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[8]+1770035416&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[9]+2336552879&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[10]+4294925233&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[12]+1804603682&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[13]+4254626195&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[14]+2792965006&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(i^a&(n^i))+r[1]+4129170786&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[6]+3225465664&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[11]+643717713&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[5]+3593408605&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[10]+38016083&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[15]+3634488961&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[9]+568446438&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[14]+3275163606&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[3]+4107603335&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[13]+2850285829&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[2]+4243563512&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[7]+1735328473&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(n^i^a)+r[5]+4294588738&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[8]+2272392833&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[11]+1839030562&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[1]+2763975236&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[4]+1272893353&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[7]+4139469664&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[13]+681279174&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[0]+3936430074&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[3]+3572445317&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[9]+3654602809&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[12]+3873151461&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[15]+530742520&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(i^(n|~a))+r[0]+4096336452&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[7]+1126891415&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[14]+2878612391&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[12]+1700485571&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[3]+2399980690&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[10]+4293915773&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[8]+1873313359&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[15]+4264355552&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[6]+2734768916&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[4]+4149444226&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[11]+3174756917&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[2]+718787259&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}r.prototype.v=function(e,t){t===void 0&&(t=e.length);let n=t-this.blockSize,r=this.C,a=this.h,o=0;for(;o<t;){if(a==0)for(;o<=n;)i(this,e,o),o+=this.blockSize;if(typeof e==`string`){for(;o<t;)if(r[a++]=e.charCodeAt(o++),a==this.blockSize){i(this,r),a=0;break}}else for(;o<t;)if(r[a++]=e[o++],a==this.blockSize){i(this,r),a=0;break}}this.h=a,this.o+=t},r.prototype.A=function(){var e=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=this.o*8;for(var n=e.length-8;n<e.length;++n)e[n]=t&255,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};function a(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}function o(e,t){this.h=t;let n=[],r=!0;for(let i=e.length-1;i>=0;i--){let a=e[i]|0;r&&a==t||(n[i]=a,r=!1)}this.g=n}var s={};function c(e){return-128<=e&&e<128?a(e,function(e){return new o([e|0],e<0?-1:0)}):new o([e|0],e<0?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return d;if(e<0)return g(l(-e));let t=[],n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new o(t,0)}function u(e,t){if(e.length==0)throw Error(`number format error: empty string`);if(t||=10,t<2||36<t)throw Error(`radix out of range: `+t);if(e.charAt(0)==`-`)return g(u(e.substring(1),t));if(e.indexOf(`-`)>=0)throw Error(`number format error: interior "-" character`);let n=l(t**8),r=d;for(let a=0;a<e.length;a+=8){var i=Math.min(8,e.length-a);let o=parseInt(e.substring(a,a+i),t);i<8?(i=l(t**+i),r=r.j(i).add(l(o))):(r=r.j(n),r=r.add(l(o)))}return r}var d=c(0),f=c(1),p=c(16777216);e=o.prototype,e.m=function(){if(h(this))return-g(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){let r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(e||=10,e<2||36<e)throw Error(`radix out of range: `+e);if(m(this))return`0`;if(h(this))return`-`+g(this).toString(e);let t=l(e**6);var n=this;let r=``;for(;;){let i=re(n,t).g;n=ee(n,i.j(t));let a=((n.g.length>0?n.g[0]:n.h)>>>0).toString(e);if(n=i,m(n))return a+r;for(;a.length<6;)a=`0`+a;r=a+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h};function m(e){if(e.h!=0)return!1;for(let t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function h(e){return e.h==-1}e.l=function(e){return e=ee(this,e),h(e)?-1:m(e)?0:1};function g(e){let t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new o(n,~e.h).add(f)}e.abs=function(){return h(this)?g(this):this},e.add=function(e){let t=Math.max(this.g.length,e.g.length),n=[],r=0;for(let i=0;i<=t;i++){let t=r+(this.i(i)&65535)+(e.i(i)&65535),a=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=a>>>16,t&=65535,a&=65535,n[i]=a<<16|t}return new o(n,n[n.length-1]&-2147483648?-1:0)};function ee(e,t){return e.add(g(t))}e.j=function(e){if(m(this)||m(e))return d;if(h(this))return h(e)?g(this).j(g(e)):g(g(this).j(e));if(h(e))return g(this.j(g(e)));if(this.l(p)<0&&e.l(p)<0)return l(this.m()*e.m());let t=this.g.length+e.g.length,n=[];for(var r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(let t=0;t<e.g.length;t++){let i=this.i(r)>>>16,a=this.i(r)&65535,o=e.i(t)>>>16,s=e.i(t)&65535;n[2*r+2*t]+=a*s,te(n,2*r+2*t),n[2*r+2*t+1]+=i*s,te(n,2*r+2*t+1),n[2*r+2*t+1]+=a*o,te(n,2*r+2*t+1),n[2*r+2*t+2]+=i*o,te(n,2*r+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new o(n,0)};function te(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function ne(e,t){this.g=e,this.h=t}function re(e,t){if(m(t))throw Error(`division by zero`);if(m(e))return new ne(d,d);if(h(e))return t=re(g(e),t),new ne(g(t.g),g(t.h));if(h(t))return t=re(e,g(t)),new ne(g(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error(`slowDivide_ only works with positive integers.`);for(var n=f,r=t;r.l(e)<=0;)n=ie(n),r=ie(r);var i=_(n,1),a=_(r,1);for(r=_(r,2),n=_(n,2);!m(r);){var o=a.add(r);o.l(e)<=0&&(i=i.add(n),a=o),r=_(r,1),n=_(n,1)}return t=ee(e,i.j(t)),new ne(i,t)}for(i=d;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=Math.ceil(Math.log(n)/Math.LN2),r=r<=48?1:2**(r-48),a=l(n),o=a.j(t);h(o)||o.l(e)>0;)n-=r,a=l(n),o=a.j(t);m(a)&&(a=f),i=i.add(a),e=ee(e,o)}return new ne(i,e)}e.B=function(e){return re(this,e).h},e.and=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new o(n,this.h&e.h)},e.or=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new o(n,this.h|e.h)},e.xor=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new o(n,this.h^e.h)};function ie(e){let t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new o(n,e.h)}function _(e,t){let n=t>>5;t%=32;let r=e.g.length-n,i=[];for(let a=0;a<r;a++)i[a]=t>0?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new o(i,e.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,an.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=u,on=an.Integer=o}).apply(rn===void 0?typeof self<`u`?self:typeof window<`u`?window:{}:rn);var sn=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},cn={},ln,un,dn,fn,pn,mn,hn,gn;(function(){var e,t=Object.defineProperty;function n(e){e=[typeof globalThis==`object`&&globalThis,e,typeof window==`object`&&window,typeof self==`object`&&self,typeof sn==`object`&&sn];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error(`Cannot find global object`)}var r=n(this);function i(e,n){if(n)a:{var i=r;e=e.split(`.`);for(var a=0;a<e.length-1;a++){var o=e[a];if(!(o in i))break a;i=i[o]}e=e[e.length-1],a=i[e],n=n(a),n!=a&&n!=null&&t(i,e,{configurable:!0,writable:!0,value:n})}}i(`Symbol.dispose`,function(e){return e||Symbol(`Symbol.dispose`)}),i(`Array.prototype.values`,function(e){return e||function(){return this[Symbol.iterator]()}}),i(`Object.entries`,function(e){return e||function(e){var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push([n,e[n]]);return t}});var a=a||{},o=this||self;function s(e){var t=typeof e;return t==`object`&&e!=null||t==`function`}function c(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return l=c,l.apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}var f=typeof AsyncContext<`u`&&typeof AsyncContext.Snapshot==`function`?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function p(e){let t=e.length;if(t>0){let n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function m(e,t){for(let t=1;t<arguments.length;t++){let r=arguments[t];var n=typeof r;if(n=n==`object`?r?Array.isArray(r)?`array`:n:`null`:n,n==`array`||n==`object`&&typeof r.length==`number`){n=e.length||0;let t=r.length||0;e.length=n+t;for(let i=0;i<t;i++)e[n+i]=r[i]}else e.push(r)}}class h{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function g(e){o.setTimeout(()=>{throw e},0)}function ee(){var e=ae;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class te{constructor(){this.h=this.g=null}add(e,t){let n=ne.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}var ne=new h(()=>new re,e=>e.reset());class re{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let ie,_=!1,ae=new te,oe=()=>{let e=Promise.resolve(void 0);ie=()=>{e.then(se)}};function se(){for(var e;e=ee();){try{e.h.call(e.g)}catch(e){g(e)}var t=ne;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}_=!1}function v(){this.u=this.u,this.C=this.C}v.prototype.u=!1,v.prototype.dispose=function(){this.u||(this.u=!0,this.N())},v.prototype[Symbol.dispose]=function(){this.dispose()},v.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function y(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}y.prototype.h=function(){this.defaultPrevented=!0};var ce=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},`passive`,{get:function(){e=!0}});try{let e=()=>{};o.addEventListener(`test`,e,t),o.removeEventListener(`test`,e,t)}catch{}return e}();function le(e){return/^[\s\xa0]*$/.test(e)}function ue(e,t){y.call(this,e?e.type:``),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=``,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType=``,this.i=null,e&&this.init(e,t)}d(ue,y),ue.prototype.init=function(e,t){let n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget,t||(n==`mouseover`?t=e.fromElement:n==`mouseout`&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=r.clientX===void 0?r.pageX:r.clientX,this.clientY=r.clientY===void 0?r.pageY:r.clientY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX===void 0?e.pageX:e.clientX,this.clientY=e.clientY===void 0?e.pageY:e.clientY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||``,this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&ue.Z.h.call(this)},ue.prototype.h=function(){ue.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var de=`closure_listenable_`+(Math.random()*1e6|0),fe=0;function pe(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++fe,this.da=this.fa=!1}function me(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function he(e,t,n){for(let r in e)t.call(n,e[r],r,e)}function ge(e,t){for(let n in e)t.call(void 0,e[n],n,e)}function _e(e){let t={};for(let n in e)t[n]=e[n];return t}let ve=`constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf`.split(` `);function ye(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<ve.length;t++)n=ve[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function be(e){this.src=e,this.g={},this.h=0}be.prototype.add=function(e,t,n,r,i){let a=e.toString();e=this.g[a],e||(e=this.g[a]=[],this.h++);let o=Se(e,t,r,i);return o>-1?(t=e[o],n||(t.fa=!1)):(t=new pe(t,this.src,a,!!r,i),t.fa=n,e.push(t)),t};function xe(e,t){let n=t.type;if(n in e.g){var r=e.g[n],i=Array.prototype.indexOf.call(r,t,void 0),a;(a=i>=0)&&Array.prototype.splice.call(r,i,1),a&&(me(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function Se(e,t,n,r){for(let i=0;i<e.length;++i){let a=e[i];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}var Ce=`closure_lm_`+(Math.random()*1e6|0),we={};function b(e,t,n,r,i){if(r&&r.once)return De(e,t,n,r,i);if(Array.isArray(t)){for(let a=0;a<t.length;a++)b(e,t[a],n,r,i);return null}return n=Pe(n),e&&e[de]?e.J(t,n,s(r)?!!r.capture:!!r,i):Te(e,t,n,!1,r,i)}function Te(e,t,n,r,i,a){if(!t)throw Error(`Invalid event type`);let o=s(i)?!!i.capture:!!i,c=Me(e);if(c||(e[Ce]=c=new be(e)),n=c.add(t,n,r,o,a),n.proxy)return n;if(r=Ee(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)ce||(i=o),i===void 0&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Ae(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error(`addEventListener and attachEvent are unavailable.`);return n}function Ee(){function e(n){return t.call(e.src,e.listener,n)}let t=je;return e}function De(e,t,n,r,i){if(Array.isArray(t)){for(let a=0;a<t.length;a++)De(e,t[a],n,r,i);return null}return n=Pe(n),e&&e[de]?e.K(t,n,s(r)?!!r.capture:!!r,i):Te(e,t,n,!0,r,i)}function Oe(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Oe(e,t[a],n,r,i);else r=s(r)?!!r.capture:!!r,n=Pe(n),e&&e[de]?(e=e.i,a=String(t).toString(),a in e.g&&(t=e.g[a],n=Se(t,n,r,i),n>-1&&(me(t[n]),Array.prototype.splice.call(t,n,1),t.length==0&&(delete e.g[a],e.h--)))):(e&&=Me(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Se(t,n,r,i)),(n=e>-1?t[e]:null)&&ke(n))}function ke(e){if(typeof e!=`number`&&e&&!e.da){var t=e.src;if(t&&t[de])xe(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Ae(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Me(t))?(xe(n,e),n.h==0&&(n.src=null,t[Ce]=null)):me(e)}}}function Ae(e){return e in we?we[e]:we[e]=`on`+e}function je(e,t){if(e.da)e=!0;else{t=new ue(t,this);let n=e.listener,r=e.ha||e.src;e.fa&&ke(e),e=n.call(r,t)}return e}function Me(e){return e=e[Ce],e instanceof be?e:null}var Ne=`__closure_events_fn_`+(Math.random()*1e9>>>0);function Pe(e){return typeof e==`function`?e:(e[Ne]||(e[Ne]=function(t){return e.handleEvent(t)}),e[Ne])}function x(){v.call(this),this.i=new be(this),this.M=this,this.G=null}d(x,v),x.prototype[de]=!0,x.prototype.removeEventListener=function(e,t,n,r){Oe(this,e,t,n,r)};function S(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,typeof t==`string`)t=new y(t,e);else if(t instanceof y)t.target=t.target||e;else{var i=t;t=new y(r,e),ye(t,i)}i=!0;let a,o;if(n)for(o=n.length-1;o>=0;o--)a=t.g=n[o],i=Fe(a,r,!0,t)&&i;if(a=t.g=e,i=Fe(a,r,!0,t)&&i,i=Fe(a,r,!1,t)&&i,n)for(o=0;o<n.length;o++)a=t.g=n[o],i=Fe(a,r,!1,t)&&i}x.prototype.N=function(){if(x.Z.N.call(this),this.i){var e=this.i;for(let t in e.g){let n=e.g[t];for(let e=0;e<n.length;e++)me(n[e]);delete e.g[t],e.h--}}this.G=null},x.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},x.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};function Fe(e,t,n,r){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();let i=!0;for(let a=0;a<t.length;++a){let o=t[a];if(o&&!o.da&&o.capture==n){let t=o.listener,n=o.ha||o.src;o.fa&&xe(e.i,o),i=t.call(n,r)!==!1&&i}}return i&&!r.defaultPrevented}function Ie(e,t){if(typeof e!=`function`)if(e&&typeof e.handleEvent==`function`)e=l(e.handleEvent,e);else throw Error(`Invalid listener argument`);return Number(t)>2147483647?-1:o.setTimeout(e,t||0)}function Le(e){e.g=Ie(()=>{e.g=null,e.i&&(e.i=!1,Le(e))},e.l);let t=e.h;e.h=null,e.m.apply(null,t)}class Re extends v{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:Le(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ze(e){v.call(this),this.h=e,this.g={}}d(ze,v);var Be=[];function Ve(e){he(e.g,function(e,t){this.g.hasOwnProperty(t)&&ke(e)},e),e.g={}}ze.prototype.N=function(){ze.Z.N.call(this),Ve(this)},ze.prototype.handleEvent=function(){throw Error(`EventHandler.handleEvent not implemented`)};var He=o.JSON.stringify,Ue=o.JSON.parse,We=class{stringify(e){return o.JSON.stringify(e,void 0)}parse(e){return o.JSON.parse(e,void 0)}};function Ge(){}function Ke(){}var qe={OPEN:`a`,hb:`b`,ERROR:`c`,tb:`d`};function Je(){y.call(this,`d`)}d(Je,y);function Ye(){y.call(this,`c`)}d(Ye,y);var Xe={},Ze=null;function Qe(){return Ze||=new x}Xe.Ia=`serverreachability`;function $e(e){y.call(this,Xe.Ia,e)}d($e,y);function et(e){let t=Qe();S(t,new $e(t))}Xe.STAT_EVENT=`statevent`;function C(e,t){y.call(this,Xe.STAT_EVENT,e),this.stat=t}d(C,y);function w(e){let t=Qe();S(t,new C(t,e))}Xe.Ja=`timingevent`;function tt(e,t){y.call(this,Xe.Ja,e),this.size=t}d(tt,y);function nt(e,t){if(typeof e!=`function`)throw Error(`Fn must not be null and must be a function`);return o.setTimeout(function(){e()},t)}function rt(){this.g=!0}rt.prototype.ua=function(){this.g=!1};function it(e,t,n,r,i,a){e.info(function(){if(e.g)if(a){var o=``,s=a.split(`&`);for(let e=0;e<s.length;e++){var c=s[e].split(`=`);if(c.length>1){let e=c[0];c=c[1];let t=e.split(`_`);o=t.length>=2&&t[1]==`type`?o+(e+`=`+c+`&`):o+(e+`=redacted&`)}}}else o=null;else o=a;return`XMLHTTP REQ (`+r+`) [attempt `+i+`]: `+t+`
`+n+`
`+o})}function at(e,t,n,r,i,a,o){e.info(function(){return`XMLHTTP RESP (`+r+`) [ attempt `+i+`]: `+t+`
`+n+`
`+a+` `+o})}function ot(e,t,n,r){e.info(function(){return`XMLHTTP TEXT (`+t+`): `+ct(e,n)+(r?` `+r:``)})}function st(e,t){e.info(function(){return`TIMEOUT: `+t})}rt.prototype.info=function(){};function ct(e,t){if(!e.g)return t;if(!t)return null;try{let a=JSON.parse(t);if(a){for(e=0;e<a.length;e++)if(Array.isArray(a[e])){var n=a[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if(i!=`noop`&&i!=`stop`&&i!=`close`)for(let e=1;e<r.length;e++)r[e]=``}}}}return He(a)}catch{return t}}var lt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ut={ib:`complete`,Fb:`success`,ERROR:`error`,Ga:`abort`,xb:`ready`,yb:`readystatechange`,TIMEOUT:`timeout`,sb:`incrementaldata`,wb:`progress`,lb:`downloadprogress`,Nb:`uploadprogress`},dt;function ft(){}d(ft,Ge),ft.prototype.g=function(){return new XMLHttpRequest},dt=new ft;function pt(e){return encodeURIComponent(String(e))}function mt(e){var t=1;e=e.split(`:`);let n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(`:`)),n}function ht(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ze(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new gt}function gt(){this.i=null,this.g=``,this.h=!1}var _t={},vt={};function yt(e,t,n){e.M=1,e.A=Wt(T(t)),e.u=n,e.R=!0,bt(e,null)}function bt(e,t){e.F=Date.now(),wt(e),e.B=T(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),an(n.i,`t`,r),e.C=0,n=e.j.L,e.h=new gt,e.g=qn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new Re(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i=`readystatechange`;Array.isArray(i)||(i&&(Be[0]=i.toString()),i=Be);for(let e=0;e<i.length;e++){let a=b(n,i[e],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.J?_e(e.J):{},e.u?(e.v||=`POST`,t[`Content-Type`]=`application/x-www-form-urlencoded`,e.g.ea(e.B,e.v,e.u,t)):(e.v=`GET`,e.g.ea(e.B,e.v,null,t)),et(),it(e.i,e.v,e.B,e.l,e.S,e.u)}ht.prototype.ba=function(e){e=e.target;let t=this.O;t&&On(e)==3?t.j():this.Y(e)},ht.prototype.Y=function(e){try{if(e==this.g)a:{let s=On(this.g),c=this.g.ya(),l=this.g.ca();if(!(s<3)&&(s!=3||this.g&&(this.h.h||this.g.la()||kn(this.g)))){this.K||s!=4||c==7||et(c==8||l<=0?3:2),Et(this);var t=this.g.ca();this.X=t;var n=xt(this);if(this.o=t==200,at(this.i,this.v,this.B,this.l,this.S,s,t),this.o){if(this.U&&!this.L){b:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader(`X-HTTP-Initial-Response`):null)&&!le(r)){var a=r;break b}}a=null}if(e=a)ot(this.i,this.l,e,`Initial handshake response via X-HTTP-Initial-Response`),this.L=!0,kt(this,e);else{this.o=!1,this.m=3,w(12),Ot(this),Dt(this);break a}}if(this.R){e=!0;let t;for(;!this.K&&this.C<n.length;)if(t=Ct(this,n),t==vt){s==4&&(this.m=4,w(14),e=!1),ot(this.i,this.l,null,`[Incomplete Response]`);break}else if(t==_t){this.m=4,w(15),ot(this.i,this.l,n,`[Invalid Chunk]`),e=!1;break}else ot(this.i,this.l,t,null),kt(this,t);if(St(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),s!=4||n.length!=0||this.h.h||(this.m=1,w(16),e=!1),this.o=this.o&&e,!e)ot(this.i,this.l,n,`[Invalid Chunked Response]`),Ot(this),Dt(this);else if(n.length>0&&!this.W){this.W=!0;var o=this.j;o.g==this&&o.aa&&!o.P&&(o.j.info(`Great, no buffering proxy detected. Bytes received: `+n.length),L(o),o.P=!0,w(11))}}else ot(this.i,this.l,n,null),kt(this,n);s==4&&Ot(this),this.o&&!this.K&&(s==4?z(this.j,this):(this.o=!1,wt(this)))}else An(this.g),t==400&&n.indexOf(`Unknown SID`)>0?(this.m=3,w(12)):(this.m=0,w(13)),Ot(this),Dt(this)}}}catch{}};function xt(e){if(!St(e))return e.g.la();let t=kn(e.g);if(t===``)return``;let n=``,r=t.length,i=On(e.g)==4;if(!e.h.i){if(typeof TextDecoder>`u`)return Ot(e),Dt(e),``;e.h.i=new o.TextDecoder}for(let a=0;a<r;a++)e.h.h=!0,n+=e.h.i.decode(t[a],{stream:!(i&&a==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}function St(e){return e.g?e.v==`GET`&&e.M!=2&&e.j.Aa:!1}function Ct(e,t){var n=e.C,r=t.indexOf(`
`,n);return r==-1?vt:(n=Number(t.substring(n,r)),isNaN(n)?_t:(r+=1,r+n>t.length?vt:(t=t.slice(r,r+n),e.C=r+n,t)))}ht.prototype.cancel=function(){this.K=!0,Ot(this)};function wt(e){e.T=Date.now()+e.H,Tt(e,e.H)}function Tt(e,t){if(e.D!=null)throw Error(`WatchDog timer not null`);e.D=nt(l(e.aa,e),t)}function Et(e){e.D&&=(o.clearTimeout(e.D),null)}ht.prototype.aa=function(){this.D=null;let e=Date.now();e-this.T>=0?(st(this.i,this.B),this.M!=2&&(et(),w(17)),Ot(this),this.m=2,Dt(this)):Tt(this,this.T-e)};function Dt(e){e.j.I==0||e.K||z(e.j,e)}function Ot(e){Et(e);var t=e.O;t&&typeof t.dispose==`function`&&t.dispose(),e.O=null,Ve(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function kt(e,t){try{var n=e.j;if(n.I!=0&&(n.g==e||Pt(n.h,e))){if(!e.L&&Pt(n.h,e)&&n.I==3){try{var r=n.Ba.g.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){a:if(!n.v){if(n.g)if(n.g.F+3e3<e.F)R(n),Pn(n);else break a;Vn(n),w(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&n.A==0&&!n.C&&(n.C=nt(l(n.Va,n),6e3));Nt(n.h)<=1&&n.ta&&(n.ta=void 0)}else Wn(n,11)}else if((e.L||n.g==e)&&R(n),!le(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let l=i[t],u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],n.I==2)if(l[0]==`c`){n.M=l[1],n.ba=l[2];let t=l[3];t!=null&&(n.ka=t,n.j.info(`VER=`+n.ka));let i=l[4];i!=null&&(n.za=i,n.j.info(`SVER=`+n.za));let u=l[5];u!=null&&typeof u==`number`&&u>0&&(r=1.5*u,n.O=r,n.j.info(`backChannelRequestTimeoutMs_=`+r)),r=n;let d=e.g;if(d){let e=d.g?d.g.getResponseHeader(`X-Client-Wire-Protocol`):null;if(e){var a=r.h;a.g||e.indexOf(`spdy`)==-1&&e.indexOf(`quic`)==-1&&e.indexOf(`h2`)==-1||(a.j=a.l,a.g=new Set,a.h&&=(Ft(a,a.h),null))}if(r.G){let e=d.g?d.g.getResponseHeader(`X-HTTP-Session-Id`):null;e&&(r.wa=e,E(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info(`Handshake RTT: `+n.T+`ms`)),r=n;var o=e;if(r.na=Kn(r,r.L?r.ba:null,r.W),o.L){It(r.h,o);var s=o,c=r.O;c&&(s.H=c),s.D&&(Et(s),wt(s)),r.g=o}else Bn(r);n.i.length>0&&Fn(n)}else l[0]!=`stop`&&l[0]!=`close`||Wn(n,7);else n.I==3&&(l[0]==`stop`||l[0]==`close`?l[0]==`stop`?Wn(n,7):Nn(n):l[0]!=`noop`&&n.l&&n.l.qa(l),n.A=0)}}et(4)}catch{}}var At=class{constructor(e,t){this.g=e,this.map=t}};function jt(e){this.l=e||10,o.PerformanceNavigationTiming?(e=o.performance.getEntriesByType(`navigation`),e=e.length>0&&(e[0].nextHopProtocol==`hq`||e[0].nextHopProtocol==`h2`)):e=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Mt(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function Nt(e){return e.h?1:e.g?e.g.size:0}function Pt(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Ft(e,t){e.g?e.g.add(t):e.h=t}function It(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}jt.prototype.cancel=function(){if(this.i=Lt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let e of this.g.values())e.cancel();this.g.clear()}};function Lt(e){if(e.h!=null)return e.i.concat(e.h.G);if(e.g!=null&&e.g.size!==0){let t=e.i;for(let n of e.g.values())t=t.concat(n.G);return t}return p(e.i)}var Rt=RegExp(`^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$`);function zt(e,t){if(e){e=e.split(`&`);for(let n=0;n<e.length;n++){let r=e[n].indexOf(`=`),i,a=null;r>=0?(i=e[n].substring(0,r),a=e[n].substring(r+1)):i=e[n],t(i,a?decodeURIComponent(a.replace(/\+/g,` `)):``)}}}function Bt(e){this.g=this.o=this.j=``,this.u=null,this.m=this.h=``,this.l=!1;let t;e instanceof Bt?(this.l=e.l,Vt(this,e.j),this.o=e.o,this.g=e.g,Ht(this,e.u),this.h=e.h,Ut(this,on(e.i)),this.m=e.m):e&&(t=String(e).match(Rt))?(this.l=!1,Vt(this,t[1]||``,!0),this.o=Gt(t[2]||``),this.g=Gt(t[3]||``,!0),Ht(this,t[4]),this.h=Gt(t[5]||``,!0),Ut(this,t[6]||``,!0),this.m=Gt(t[7]||``)):(this.l=!1,this.i=new $t(null,this.l))}Bt.prototype.toString=function(){let e=[];var t=this.j;t&&e.push(Kt(t,Jt,!0),`:`);var n=this.g;return(n||t==`file`)&&(e.push(`//`),(t=this.o)&&e.push(Kt(t,Jt,!0),`@`),e.push(pt(n).replace(/%25([0-9a-fA-F]{2})/g,`%$1`)),n=this.u,n!=null&&e.push(`:`,String(n))),(n=this.h)&&(this.g&&n.charAt(0)!=`/`&&e.push(`/`),e.push(Kt(n,n.charAt(0)==`/`?Xt:Yt,!0))),(n=this.i.toString())&&e.push(`?`,n),(n=this.m)&&e.push(`#`,Kt(n,Qt)),e.join(``)},Bt.prototype.resolve=function(e){let t=T(this),n=!!e.j;n?Vt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=e.u!=null;var r=e.h;if(n)Ht(t,e.u);else if(n=!!e.h){if(r.charAt(0)!=`/`)if(this.g&&!this.h)r=`/`+r;else{var i=t.h.lastIndexOf(`/`);i!=-1&&(r=t.h.slice(0,i+1)+r)}if(i=r,i==`..`||i==`.`)r=``;else if(i.indexOf(`./`)!=-1||i.indexOf(`/.`)!=-1){r=i.lastIndexOf(`/`,0)==0,i=i.split(`/`);let e=[];for(let t=0;t<i.length;){let n=i[t++];n==`.`?r&&t==i.length&&e.push(``):n==`..`?((e.length>1||e.length==1&&e[0]!=``)&&e.pop(),r&&t==i.length&&e.push(``)):(e.push(n),r=!0)}r=e.join(`/`)}else r=i}return n?t.h=r:n=e.i.toString()!==``,n?Ut(t,on(e.i)):n=!!e.m,n&&(t.m=e.m),t};function T(e){return new Bt(e)}function Vt(e,t,n){e.j=n?Gt(t,!0):t,e.j&&=e.j.replace(/:$/,``)}function Ht(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error(`Bad port number `+t);e.u=t}else e.u=null}function Ut(e,t,n){t instanceof $t?(e.i=t,vn(e.i,e.l)):(n||(t=Kt(t,Zt)),e.i=new $t(t,e.l))}function E(e,t,n){e.i.set(t,n)}function Wt(e){return E(e,`zx`,Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),e}function Gt(e,t){return e?t?decodeURI(e.replace(/%25/g,`%2525`)):decodeURIComponent(e):``}function Kt(e,t,n){return typeof e==`string`?(e=encodeURI(e).replace(t,qt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,`%$1`)),e):null}function qt(e){return e=e.charCodeAt(0),`%`+(e>>4&15).toString(16)+(e&15).toString(16)}var Jt=/[#\/\?@]/g,Yt=/[#\?:]/g,Xt=/[#\?]/g,Zt=/[#\?@]/g,Qt=/#/g;function $t(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function en(e){e.g||(e.g=new Map,e.h=0,e.i&&zt(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g,` `)),n)}))}e=$t.prototype,e.add=function(e,t){en(this),this.i=null,e=_n(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function tn(e,t){en(e),t=_n(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function nn(e,t){return en(e),t=_n(e,t),e.g.has(t)}e.forEach=function(e,t){en(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)};function rn(e,t){en(e);let n=[];if(typeof t==`string`)nn(e,t)&&(n=n.concat(e.g.get(_n(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}e.set=function(e,t){return en(this),this.i=null,e=_n(this,e),nn(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e?(e=rn(this,e),e.length>0?String(e[0]):t):t};function an(e,t,n){tn(e,t),n.length>0&&(e.i=null,e.g.set(_n(e,t),p(n)),e.h+=n.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return``;let e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];let i=pt(n);n=rn(this,n);for(let t=0;t<n.length;t++){let r=i;n[t]!==``&&(r+=`=`+pt(n[t])),e.push(r)}}return this.i=e.join(`&`)};function on(e){let t=new $t;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function _n(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function vn(e,t){t&&!e.j&&(en(e),e.i=null,e.g.forEach(function(e,t){let n=t.toLowerCase();t!=n&&(tn(this,t),an(this,n,e))},e)),e.j=t}function D(e,t){let n=new rt;if(o.Image){let r=new Image;r.onload=u(O,n,`TestLoadImage: loaded`,!0,t,r),r.onerror=u(O,n,`TestLoadImage: error`,!1,t,r),r.onabort=u(O,n,`TestLoadImage: abort`,!1,t,r),r.ontimeout=u(O,n,`TestLoadImage: timeout`,!1,t,r),o.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function yn(e,t){let n=new rt,r=new AbortController,i=setTimeout(()=>{r.abort(),O(n,`TestPingServer: timeout`,!1,t)},1e4);fetch(e,{signal:r.signal}).then(e=>{clearTimeout(i),e.ok?O(n,`TestPingServer: ok`,!0,t):O(n,`TestPingServer: server error`,!1,t)}).catch(()=>{clearTimeout(i),O(n,`TestPingServer: error`,!1,t)})}function O(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch{}}function bn(){this.g=new We}function k(e){this.i=e.Sb||null,this.h=e.ab||!1}d(k,Ge),k.prototype.g=function(){return new A(this.i,this.h)};function A(e,t){x.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText=``,this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F=`GET`,this.D=``,this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(A,x),e=A.prototype,e.open=function(e,t){if(this.readyState!=0)throw this.abort(),Error(`Error reopening a connection`);this.F=e,this.D=t,this.readyState=1,j(this)},e.send=function(e){if(this.readyState!=1)throw this.abort(),Error(`need to call open() first. `);if(this.v.signal.aborted)throw this.abort(),Error(`Request was aborted.`);this.g=!0;let t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||o).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText=``,this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel(`Request was aborted.`).catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Sn(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,j(this)),this.g&&(this.readyState=3,j(this),this.g)))if(this.responseType===`arraybuffer`)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(o.ReadableStream!==void 0&&`body`in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error(`responseType must be empty for "streamBinaryChunks" mode responses.`);this.response=[]}else this.response=this.responseText=``,this.B=new TextDecoder;xn(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))};function xn(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array;(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Sn(this):j(this),this.readyState==3&&xn(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,Sn(this))},e.Na=function(e){this.g&&(this.response=e,Sn(this))},e.ga=function(){this.g&&Sn(this)};function Sn(e){e.readyState=4,e.l=null,e.j=null,e.B=null,j(e)}e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||``},e.getAllResponseHeaders=function(){if(!this.h)return``;let e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+`: `+n[1]),n=t.next();return e.join(`\r
`)};function j(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(A.prototype,`withCredentials`,{get:function(){return this.m===`include`},set:function(e){this.m=e?`include`:`same-origin`}});function Cn(e){let t=``;return he(e,function(e,n){t+=n,t+=`:`,t+=e,t+=`\r
`}),t}function M(e,t,n){a:{for(r in n){var r=!1;break a}r=!0}r||(n=Cn(n),typeof e==`string`||E(e,t,n))}function N(e){x.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D=``,this.o=0,this.l=``,this.j=this.B=this.v=this.A=!1,this.m=null,this.F=``,this.H=!1}d(N,x);var P=/^https?$/i,F=[`POST`,`PUT`];e=N.prototype,e.Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error(`[goog.net.XhrIo] Object is active with another request=`+this.D+`; newUri=`+e);t=t?t.toUpperCase():`GET`,this.D=e,this.l=``,this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():dt.g(),this.g.onreadystatechange=f(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){wn(this,e);return}if(e=n||``,n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys==`function`&&typeof r.get==`function`)for(let e of r.keys())n.set(e,r.get(e));else throw Error(`Unknown input type for opt_headers: `+String(r));r=Array.from(n.keys()).find(e=>e.toLowerCase()==`content-type`),i=o.FormData&&e instanceof o.FormData,!(Array.prototype.indexOf.call(F,t,void 0)>=0)||r||i||n.set(`Content-Type`,`application/x-www-form-urlencoded;charset=utf-8`);for(let[e,t]of n)this.g.setRequestHeader(e,t);this.F&&(this.g.responseType=this.F),`withCredentials`in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&=(clearTimeout(this.m),null),this.v=!0,this.g.send(e),this.v=!1}catch(e){wn(this,e)}};function wn(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Tn(e),Dn(e)}function Tn(e){e.A||(e.A=!0,S(e,`complete`),S(e,`error`))}e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,S(this,`complete`),S(this,`abort`),Dn(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Dn(this,!0)),N.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?En(this):this.Xa())},e.Xa=function(){En(this)};function En(e){if(e.h&&a!==void 0){if(e.v&&On(e)==4)setTimeout(e.Ca.bind(e),0);else if(S(e,`readystatechange`),On(e)==4){e.h=!1;try{let a=e.ca();a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break a;default:t=!1}var n;if(!(n=t)){var r;if(r=a===0){let t=String(e.D).match(Rt)[1]||null;!t&&o.self&&o.self.location&&(t=o.self.location.protocol.slice(0,-1)),r=!P.test(t?t.toLowerCase():``)}n=r}if(n)S(e,`complete`),S(e,`success`);else{e.o=6;try{var i=On(e)>2?e.g.statusText:``}catch{i=``}e.l=i+` [`+e.ca()+`]`,Tn(e)}}finally{Dn(e)}}}}function Dn(e,t){if(e.g){e.m&&=(clearTimeout(e.m),null);let n=e.g;e.g=null,t||S(e,`ready`);try{n.onreadystatechange=null}catch{}}}e.isActive=function(){return!!this.g};function On(e){return e.g?e.g.readyState:0}e.ca=function(){try{return On(this)>2?this.g.status:-1}catch{return-1}},e.la=function(){try{return this.g?this.g.responseText:``}catch{return``}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),Ue(t)}};function kn(e){try{if(!e.g)return null;if(`response`in e.g)return e.g.response;switch(e.F){case``:case`text`:return e.g.responseText;case`arraybuffer`:if(`mozResponseArrayBuffer`in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function An(e){let t={};e=(e.g&&On(e)>=2&&e.g.getAllResponseHeaders()||``).split(`\r
`);for(let r=0;r<e.length;r++){if(le(e[r]))continue;var n=mt(e[r]);let i=n[0];if(n=n[1],typeof n!=`string`)continue;n=n.trim();let a=t[i]||[];t[i]=a,a.push(n)}ge(t,function(e){return e.join(`, `)})}e.ya=function(){return this.o},e.Ha=function(){return typeof this.l==`string`?this.l:String(this.l)};function jn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Mn(e){this.za=0,this.i=[],this.j=new rt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=jn(`failFast`,!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=jn(`baseRetryDelayMs`,5e3,e),this.Za=jn(`retryDelaySeedMs`,1e4,e),this.Ta=jn(`forwardChannelMaxRetries`,2,e),this.va=jn(`forwardChannelRequestTimeoutMs`,2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M=``,this.h=new jt(e&&e.concurrentRequestLimit),this.Ba=new bn,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}e=Mn.prototype,e.ka=8,e.I=1,e.connect=function(e,t,n,r){w(0),this.W=e,this.H=t||{},n&&r!==void 0&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=Kn(this,null,this.W),Fn(this)};function Nn(e){if(I(e),e.I==3){var t=e.V++,n=T(e.J);if(E(n,`SID`,e.M),E(n,`RID`,t),E(n,`TYPE`,`terminate`),Rn(e,n),t=new ht(e,e.j,t),t.M=2,t.A=Wt(T(n)),n=!1,o.navigator&&o.navigator.sendBeacon)try{n=o.navigator.sendBeacon(t.A.toString(),``)}catch{}!n&&o.Image&&(new Image().src=t.A,n=!0),n||(t.g=qn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),wt(t)}Gn(e)}function Pn(e){e.g&&=(L(e),e.g.cancel(),null)}function I(e){Pn(e),e.v&&=(o.clearTimeout(e.v),null),R(e),e.h.cancel(),e.m&&=(typeof e.m==`number`&&o.clearTimeout(e.m),null)}function Fn(e){if(!Mt(e.h)&&!e.m){e.m=!0;var t=e.Ea;ie||oe(),_||=(ie(),!0),ae.add(t,e),e.D=0}}function In(e,t){return Nt(e.h)>=e.h.j-(e.m?1:0)?!1:e.m?(e.i=t.G.concat(e.i),!0):e.I==1||e.I==2||e.D>=(e.Sa?0:e.Ta)?!1:(e.m=nt(l(e.Ea,e,t),Un(e,e.D)),e.D++,!0)}e.Ea=function(e){if(this.m)if(this.m=null,this.I==1){if(!e){this.V=Math.floor(Math.random()*1e5),e=this.V++;let i=new ht(this,this.j,e),a=this.o;if(this.U&&(a?(a=_e(a),ye(a,this.U)):a=this.U),this.u!==null||this.R||(i.J=a,a=null),this.S)a:{for(var t=0,n=0;n<this.i.length;n++){b:{var r=this.i[n];if(`__data__`in r.map&&(r=r.map.__data__,typeof r==`string`)){r=r.length;break b}r=void 0}if(r===void 0)break;if(t+=r,t>4096){t=n;break a}if(t===4096||n===this.i.length-1){t=n+1;break a}}t=1e3}else t=1e3;t=zn(this,i,t),n=T(this.J),E(n,`RID`,e),E(n,`CVER`,22),this.G&&E(n,`X-HTTP-Session-Id`,this.G),Rn(this,n),a&&(this.R?t=`headers=`+pt(Cn(a))+`&`+t:this.u&&M(n,this.u,a)),Ft(this.h,i),this.Ra&&E(n,`TYPE`,`init`),this.S?(E(n,`$req`,t),E(n,`SID`,`null`),i.U=!0,yt(i,n,null)):yt(i,n,t),this.I=2}}else this.I==3&&(e?Ln(this,e):this.i.length==0||Mt(this.h)||Ln(this))};function Ln(e,t){var n=t?t.l:e.V++;let r=T(e.J);E(r,`SID`,e.M),E(r,`RID`,n),E(r,`AID`,e.K),Rn(e,r),e.u&&e.o&&M(r,e.u,e.o),n=new ht(e,e.j,n,e.D+1),e.u===null&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=zn(e,n,1e3),n.H=Math.round(e.va*.5)+Math.round(e.va*.5*Math.random()),Ft(e.h,n),yt(n,r,t)}function Rn(e,t){e.H&&he(e.H,function(e,n){E(t,n,e)}),e.l&&he({},function(e,n){E(t,n,e)})}function zn(e,t,n){n=Math.min(e.i.length,n);let r=e.l?l(e.l.Ka,e.l,e):null;a:{var i=e.i;let t=-1;for(;;){let e=[`count=`+n];t==-1?n>0?(t=i[0].g,e.push(`ofs=`+t)):t=0:e.push(`ofs=`+t);let c=!0;for(let l=0;l<n;l++){var a=i[l].g;let n=i[l].map;if(a-=t,a<0)t=Math.max(0,i[l].g-100),c=!1;else try{a=`req`+a+`_`||``;try{var o=n instanceof Map?n:Object.entries(n);for(let[t,n]of o){let r=n;s(n)&&(r=He(n)),e.push(a+t+`=`+encodeURIComponent(r))}}catch(t){throw e.push(a+`type=_badmap`),t}}catch{r&&r(n)}}if(c){o=e.join(`&`);break a}}o=void 0}return e=e.i.splice(0,n),t.G=e,o}function Bn(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;ie||oe(),_||=(ie(),!0),ae.add(t,e),e.A=0}}function Vn(e){return e.g||e.v||e.A>=3?!1:(e.Y++,e.v=nt(l(e.Da,e),Un(e,e.A)),e.A++,!0)}e.Da=function(){if(this.v=null,Hn(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var e=4*this.T;this.j.info(`BP detection timer enabled: `+e),this.B=nt(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info(`BP detection timeout reached.`),this.j.info(`Buffering proxy detected and switch to long-polling!`),this.F=!1,this.P=!0,w(10),Pn(this),Hn(this))};function L(e){e.B!=null&&(o.clearTimeout(e.B),e.B=null)}function Hn(e){e.g=new ht(e,e.j,`rpc`,e.Y),e.u===null&&(e.g.J=e.o),e.g.P=0;var t=T(e.na);E(t,`RID`,`rpc`),E(t,`SID`,e.M),E(t,`AID`,e.K),E(t,`CI`,e.F?`0`:`1`),!e.F&&e.ia&&E(t,`TO`,e.ia),E(t,`TYPE`,`xmlhttp`),Rn(e,t),e.u&&e.o&&M(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=Wt(T(t)),n.u=null,n.R=!0,bt(n,e)}e.Va=function(){this.C!=null&&(this.C=null,Pn(this),Vn(this),w(19))};function R(e){e.C!=null&&(o.clearTimeout(e.C),e.C=null)}function z(e,t){var n=null;if(e.g==t){R(e),L(e),e.g=null;var r=2}else if(Pt(e.h,t))n=t.G,It(e.h,t),r=1;else return;if(e.I!=0){if(t.o)if(r==1){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;r=Qe(),S(r,new tt(r,n)),Fn(e)}else Bn(e);else if(i=t.m,i==3||i==0&&t.X>0||!(r==1&&In(e,t)||r==2&&Vn(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:Wn(e,5);break;case 4:Wn(e,10);break;case 3:Wn(e,6);break;default:Wn(e,2)}}}function Un(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function Wn(e,t){if(e.j.info(`Error code `+t),t==2){var n=l(e.bb,e),r=e.Ua;let t=!r;r=new Bt(r||`//www.google.com/images/cleardot.gif`),o.location&&o.location.protocol==`http`||Vt(r,`https`),Wt(r),t?D(r.toString(),n):yn(r.toString(),n)}else w(2);e.I=0,e.l&&e.l.pa(t),Gn(e),I(e)}e.bb=function(e){e?(this.j.info(`Successfully pinged google.com`),w(2)):(this.j.info(`Failed to ping google.com`),w(1))};function Gn(e){if(e.I=0,e.ja=[],e.l){let t=Lt(e.h);(t.length!=0||e.i.length!=0)&&(m(e.ja,t),m(e.ja,e.i),e.h.i.length=0,p(e.i),e.i.length=0),e.l.oa()}}function Kn(e,t,n){var r=n instanceof Bt?T(n):new Bt(n);if(r.g!=``)t&&(r.g=t+`.`+r.g),Ht(r,r.u);else{var i=o.location;r=i.protocol,t=t?t+`.`+i.hostname:i.hostname,i=+i.port;let e=new Bt(null);r&&Vt(e,r),t&&(e.g=t),i&&Ht(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&E(r,n,t),E(r,`VER`,e.ka),Rn(e,r),r}function qn(e,t,n){if(t&&!e.L)throw Error(`Can't create secondary domain capable XhrIo object.`);return t=e.Aa&&!e.ma?new N(new k({ab:n})):new N(e.ma),t.Fa(e.L),t}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Jn(){}e=Jn.prototype,e.ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){};function Yn(){}Yn.prototype.g=function(e,t){return new B(e,t)};function B(e,t){x.call(this),this.g=new Mn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e[`X-Client-Protocol`]=`webchannel`:e={"X-Client-Protocol":`webchannel`}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e[`X-WebChannel-Content-Type`]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e[`X-WebChannel-Client-Profile`]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!le(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t&&=t.httpSessionIdParam)&&!le(t)&&(this.g.G=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new Qn(this)}d(B,x),B.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},B.prototype.close=function(){Nn(this.g)},B.prototype.o=function(e){var t=this.g;if(typeof e==`string`){var n={};n.__data__=e,e=n}else this.v&&(n={},n.__data__=He(e),e=n);t.i.push(new At(t.Ya++,e)),t.I==3&&Fn(t)},B.prototype.N=function(){this.g.l=null,delete this.j,Nn(this.g),delete this.g,B.Z.N.call(this)};function Xn(e){Je.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){a:{for(let n in t){e=n;break a}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}d(Xn,Je);function Zn(){Ye.call(this),this.status=1}d(Zn,Ye);function Qn(e){this.g=e}d(Qn,Jn),Qn.prototype.ra=function(){S(this.g,`a`)},Qn.prototype.qa=function(e){S(this.g,new Xn(e))},Qn.prototype.pa=function(e){S(this.g,new Zn)},Qn.prototype.oa=function(){S(this.g,`b`)},Yn.prototype.createWebChannel=Yn.prototype.g,B.prototype.send=B.prototype.o,B.prototype.open=B.prototype.m,B.prototype.close=B.prototype.close,gn=cn.createWebChannelTransport=function(){return new Yn},hn=cn.getStatEventTarget=function(){return Qe()},mn=cn.Event=Xe,pn=cn.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},lt.NO_ERROR=0,lt.TIMEOUT=8,lt.HTTP_ERROR=6,fn=cn.ErrorCode=lt,ut.COMPLETE=`complete`,dn=cn.EventType=ut,Ke.EventType=qe,qe.OPEN=`a`,qe.CLOSE=`b`,qe.ERROR=`c`,qe.MESSAGE=`d`,x.prototype.listen=x.prototype.J,un=cn.WebChannel=Ke,cn.FetchXmlHttpFactory=k,N.prototype.listenOnce=N.prototype.K,N.prototype.getLastError=N.prototype.Ha,N.prototype.getLastErrorCode=N.prototype.ya,N.prototype.getStatus=N.prototype.ca,N.prototype.getResponseJson=N.prototype.La,N.prototype.getResponseText=N.prototype.la,N.prototype.send=N.prototype.ea,N.prototype.setWithCredentials=N.prototype.Fa,ln=cn.XhrIo=N}).apply(sn===void 0?typeof self<`u`?self:typeof window<`u`?window:{}:sn);var _n=`@firebase/firestore`,vn=`4.9.2`,D=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?`uid:`+this.uid:`anonymous-user`}isEqual(e){return e.uid===this.uid}};D.UNAUTHENTICATED=new D(null),D.GOOGLE_CREDENTIALS=new D(`google-credentials-uid`),D.FIRST_PARTY=new D(`first-party-uid`),D.MOCK_USER=new D(`mock-user`);var yn=`12.3.0`,O=new ke(`@firebase/firestore`);function bn(){return O.logLevel}function k(e,...t){if(O.logLevel<=b.DEBUG){let n=t.map(Sn);O.debug(`Firestore (${yn}): ${e}`,...n)}}function A(e,...t){if(O.logLevel<=b.ERROR){let n=t.map(Sn);O.error(`Firestore (${yn}): ${e}`,...n)}}function xn(e,...t){if(O.logLevel<=b.WARN){let n=t.map(Sn);O.warn(`Firestore (${yn}): ${e}`,...n)}}function Sn(e){if(typeof e==`string`)return e;try{return function(e){return JSON.stringify(e)}(e)}catch{return e}}function j(e,t,n){let r=`Unexpected state`;typeof t==`string`?r=t:n=t,Cn(e,r,n)}function Cn(e,t,n){let r=`FIRESTORE (${yn}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=` CONTEXT: `+JSON.stringify(n)}catch{r+=` CONTEXT: `+n}throw A(r),Error(r)}function M(e,t,n,r){let i=`Unexpected state`;typeof n==`string`?i=n:r=n,e||Cn(t,i,r)}function N(e,t){return e}var P={OK:`ok`,CANCELLED:`cancelled`,UNKNOWN:`unknown`,INVALID_ARGUMENT:`invalid-argument`,DEADLINE_EXCEEDED:`deadline-exceeded`,NOT_FOUND:`not-found`,ALREADY_EXISTS:`already-exists`,PERMISSION_DENIED:`permission-denied`,UNAUTHENTICATED:`unauthenticated`,RESOURCE_EXHAUSTED:`resource-exhausted`,FAILED_PRECONDITION:`failed-precondition`,ABORTED:`aborted`,OUT_OF_RANGE:`out-of-range`,UNIMPLEMENTED:`unimplemented`,INTERNAL:`internal`,UNAVAILABLE:`unavailable`,DATA_LOSS:`data-loss`},F=class extends de{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}},wn=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}},Tn=class{constructor(e,t){this.user=t,this.type=`OAuth`,this.headers=new Map,this.headers.set(`Authorization`,`Bearer ${e}`)}},En=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(D.UNAUTHENTICATED)))}shutdown(){}},Dn=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}},On=class{constructor(e){this.t=e,this.currentUser=D.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){M(this.o===void 0,42304);let n=this.i,r=e=>this.i===n?Promise.resolve():(n=this.i,t(e)),i=new wn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new wn,e.enqueueRetryable((()=>r(this.currentUser)))};let a=()=>{let t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{k(`FirebaseAuthCredentialsProvider`,`Auth detected`),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?o(e):(k(`FirebaseAuthCredentialsProvider`,`Auth not yet detected`),i.resolve(),i=new wn)}}),0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i===e?t?(M(typeof t.accessToken==`string`,31837,{l:t}),new Tn(t.accessToken,this.currentUser)):null:(k(`FirebaseAuthCredentialsProvider`,`getToken aborted due to token change.`),this.getToken()))):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return M(e===null||typeof e==`string`,2055,{h:e}),new D(e)}},kn=class{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type=`FirstParty`,this.user=D.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set(`X-Goog-AuthUser`,this.P);let e=this.R();return e&&this.A.set(`Authorization`,e),this.T&&this.A.set(`X-Goog-Iam-Authorization-Token`,this.T),this.A}},An=class{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new kn(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(D.FIRST_PARTY)))}shutdown(){}invalidateToken(){}},jn=class{constructor(e){this.value=e,this.type=`AppCheck`,this.headers=new Map,e&&e.length>0&&this.headers.set(`x-firebase-appcheck`,this.value)}},Mn=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ft(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){M(this.o===void 0,3512);let n=e=>{e.error!=null&&k(`FirebaseAppCheckTokenProvider`,`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let n=e.token!==this.m;return this.m=e.token,k(`FirebaseAppCheckTokenProvider`,`Received ${n?`new`:`existing`} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};let r=e=>{k(`FirebaseAppCheckTokenProvider`,`AppCheck detected`),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?r(e):k(`FirebaseAppCheckTokenProvider`,`AppCheck not yet detected`)}}),0)}getToken(){if(this.p)return Promise.resolve(new jn(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(M(typeof e.token==`string`,44558,{tokenResult:e}),this.m=e.token,new jn(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Nn(e){let t=typeof self<`u`&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues==`function`)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}var Pn=class{static newId(){let e=``;for(;e.length<20;){let t=Nn(40);for(let n=0;n<t.length;++n)e.length<20&&t[n]<248&&(e+=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789`.charAt(t[n]%62))}return e}};function I(e,t){return e<t?-1:e>t?1:0}function Fn(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++){let n=e.charAt(r),i=t.charAt(r);if(n!==i)return Rn(n)===Rn(i)?I(n,i):Rn(n)?1:-1}return I(e.length,t.length)}var In=55296,Ln=57343;function Rn(e){let t=e.charCodeAt(0);return t>=In&&t<=Ln}function zn(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}var Bn=`__name__`,Vn=class e{constructor(e,t,n){t===void 0?t=0:t>e.length&&j(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&j(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(t){return e.comparator(this,t)===0}child(t){let n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((e=>{n.push(e)})):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){let r=Math.min(t.length,n.length);for(let i=0;i<r;i++){let r=e.compareSegments(t.get(i),n.get(i));if(r!==0)return r}return I(t.length,n.length)}static compareSegments(t,n){let r=e.isNumericId(t),i=e.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?e.extractNumericId(t).compare(e.extractNumericId(n)):Fn(t,n)}static isNumericId(e){return e.startsWith(`__id`)&&e.endsWith(`__`)}static extractNumericId(e){return on.fromString(e.substring(4,e.length-2))}},L=class e extends Vn{construct(t,n,r){return new e(t,n,r)}canonicalString(){return this.toArray().join(`/`)}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join(`/`)}static fromString(...t){let n=[];for(let e of t){if(e.indexOf(`//`)>=0)throw new F(P.INVALID_ARGUMENT,`Invalid segment (${e}). Paths must not contain // in them.`);n.push(...e.split(`/`).filter((e=>e.length>0)))}return new e(n)}static emptyPath(){return new e([])}},Hn=/^[_a-zA-Z][_a-zA-Z0-9]*$/,R=class e extends Vn{construct(t,n,r){return new e(t,n,r)}static isValidIdentifier(e){return Hn.test(e)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,`\\\\`).replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(`.`)}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Bn}static keyField(){return new e([Bn])}static fromServerFormat(t){let n=[],r=``,i=0,a=()=>{if(r.length===0)throw new F(P.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=``},o=!1;for(;i<t.length;){let e=t[i];if(e===`\\`){if(i+1===t.length)throw new F(P.INVALID_ARGUMENT,`Path has trailing escape character: `+t);let e=t[i+1];if(e!==`\\`&&e!==`.`&&e!=="`")throw new F(P.INVALID_ARGUMENT,`Path has invalid escape sequence: `+t);r+=e,i+=2}else e==="`"?(o=!o,i++):e!==`.`||o?(r+=e,i++):(a(),i++)}if(a(),o)throw new F(P.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)}static emptyPath(){return new e([])}},z=class e{constructor(e){this.path=e}static fromPath(t){return new e(L.fromString(t))}static fromName(t){return new e(L.fromString(t).popFirst(5))}static empty(){return new e(L.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&L.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return L.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(t){return new e(new L(t.slice()))}};function Un(e,t,n){if(!n)throw new F(P.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Wn(e,t,n,r){if(!0===t&&!0===r)throw new F(P.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Gn(e){if(!z.isDocumentKey(e))throw new F(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Kn(e){if(z.isDocumentKey(e))throw new F(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function qn(e){return typeof e==`object`&&!!e&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function Jn(e){if(e===void 0)return`undefined`;if(e===null)return`null`;if(typeof e==`string`)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e==`number`||typeof e==`boolean`)return``+e;if(typeof e==`object`){if(e instanceof Array)return`an array`;{let t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:`an object`}}return typeof e==`function`?`a function`:j(12329,{type:typeof e})}function Yn(e,t){if(`_delegate`in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new F(P.INVALID_ARGUMENT,`Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?`);{let n=Jn(e);throw new F(P.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function B(e,t){let n={typeString:e};return t&&(n.value=t),n}function Xn(e,t){if(!qn(e))throw new F(P.INVALID_ARGUMENT,`JSON must be an object`);let n;for(let r in t)if(t[r]){let i=t[r].typeString,a=`value`in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}let o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){n=`Expected '${r}' field to equal '${a.value}'`;break}}if(n)throw new F(P.INVALID_ARGUMENT,n);return!0}var Zn=-62135596800,Qn=1e6,V=class e{static now(){return e.fromMillis(Date.now())}static fromDate(t){return e.fromMillis(t.getTime())}static fromMillis(t){let n=Math.floor(t/1e3);return new e(n,Math.floor((t-1e3*n)*Qn))}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new F(P.INVALID_ARGUMENT,`Timestamp nanoseconds out of range: `+t);if(e<Zn||e>=253402300800)throw new F(P.INVALID_ARGUMENT,`Timestamp seconds out of range: `+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Qn}_compareTo(e){return this.seconds===e.seconds?I(this.nanoseconds,e.nanoseconds):I(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return`Timestamp(seconds=`+this.seconds+`, nanoseconds=`+this.nanoseconds+`)`}toJSON(){return{type:e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Xn(t,e._jsonSchema))return new e(t.seconds,t.nanoseconds)}valueOf(){let e=this.seconds-Zn;return String(e).padStart(12,`0`)+`.`+String(this.nanoseconds).padStart(9,`0`)}};V._jsonSchemaVersion=`firestore/timestamp/1.0`,V._jsonSchema={type:B(`string`,V._jsonSchemaVersion),seconds:B(`number`),nanoseconds:B(`number`)};var H=class e{static fromTimestamp(t){return new e(t)}static min(){return new e(new V(0,0))}static max(){return new e(new V(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return`SnapshotVersion(`+this.timestamp.toString()+`)`}toTimestamp(){return this.timestamp}},$n=-1,er=class{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}};er.UNKNOWN_ID=-1;function tr(e,t){let n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1;return new rr(H.fromTimestamp(r===1e9?new V(n+1,0):new V(n,r)),z.empty(),t)}function nr(e){return new rr(e.readTime,e.key,$n)}var rr=class e{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new e(H.min(),z.empty(),$n)}static max(){return new e(H.max(),z.empty(),$n)}};function ir(e,t){let n=e.readTime.compareTo(t.readTime);return n===0?(n=z.comparator(e.documentKey,t.documentKey),n===0?I(e.largestBatchId,t.largestBatchId):n):n}var ar=`The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.`,or=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}};async function sr(e){if(e.code!==P.FAILED_PRECONDITION||e.message!==ar)throw e;k(`LocalStore`,`Unexpectedly lost primary lease`)}var U=class e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(t,n){return this.callbackAttached&&j(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(((e,r)=>{this.nextCallback=n=>{this.wrapSuccess(t,n).next(e,r)},this.catchCallback=t=>{this.wrapFailure(n,t).next(e,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(t){try{let n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}wrapSuccess(t,n){return t?this.wrapUserFunction((()=>t(n))):e.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction((()=>t(n))):e.reject(n)}static resolve(t){return new e(((e,n)=>{e(t)}))}static reject(t){return new e(((e,n)=>{n(t)}))}static waitFor(t){return new e(((e,n)=>{let r=0,i=0,a=!1;t.forEach((t=>{++r,t.next((()=>{++i,a&&i===r&&e()}),(e=>n(e)))})),a=!0,i===r&&e()}))}static or(t){let n=e.resolve(!1);for(let r of t)n=n.next((t=>t?e.resolve(t):r()));return n}static forEach(e,t){let n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(t,n){return new e(((e,r)=>{let i=t.length,a=Array(i),o=0;for(let s=0;s<i;s++){let c=s;n(t[c]).next((t=>{a[c]=t,++o,o===i&&e(a)}),(e=>r(e)))}}))}static doWhile(t,n){return new e(((e,r)=>{let i=()=>{!0===t()?n().next((()=>{i()}),r):e()};i()}))}};function cr(e){let t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(`.`).slice(0,2).join(`.`):`-1`;return Number(n)}function lr(e){return e.name===`IndexedDbTransactionError`}var ur=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}};ur.ce=-1;var dr=-1;function fr(e){return e==null}function pr(e){return e===0&&1/e==-1/0}function mr(e){return typeof e==`number`&&Number.isInteger(e)&&!pr(e)&&e<=2**53-1&&e>=-(2**53-1)}var hr=``;function gr(e){let t=``;for(let n=0;n<e.length;n++)t.length>0&&(t=vr(t)),t=_r(e.get(n),t);return vr(t)}function _r(e,t){let n=t,r=e.length;for(let t=0;t<r;t++){let r=e.charAt(t);switch(r){case`\0`:n+=``;break;case hr:n+=``;break;default:n+=r}}return n}function vr(e){return e+hr+``}function yr(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function br(e,t){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function xr(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var W=class e{constructor(e,t){this.comparator=e,this.root=t||Cr.EMPTY}insert(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Cr.BLACK,null,null))}remove(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Cr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){let e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(`, `)}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sr(this.root,e,this.comparator,!0)}},Sr=class{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Cr=class e{constructor(t,n,r,i,a){this.key=t,this.value=n,this.color=r??e.RED,this.left=i??e.EMPTY,this.right=a??e.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,a){return new e(t??this.key,n??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this,i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return e.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return 2**this.check()<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw j(43730,{key:this.key,value:this.value});if(this.right.isRed())throw j(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw j(27949);return e+(this.isRed()?0:1)}};Cr.EMPTY=null,Cr.RED=!0,Cr.BLACK=!1,Cr.EMPTY=new class{constructor(){this.size=0}get key(){throw j(57766)}get value(){throw j(16141)}get color(){throw j(16727)}get left(){throw j(29726)}get right(){throw j(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Cr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var G=class e{constructor(e){this.comparator=e,this.data=new W(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t===void 0?this.data.getIterator():this.data.getIteratorFrom(t);n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wr(this.data.getIterator())}getIteratorFrom(e){return new wr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){let e=n.getNext().key,t=r.getNext().key;if(this.comparator(e,t)!==0)return!1}return!0}toArray(){let e=[];return this.forEach((t=>{e.push(t)})),e}toString(){let e=[];return this.forEach((t=>e.push(t))),`SortedSet(`+e.toString()+`)`}copy(t){let n=new e(this.comparator);return n.data=t,n}},wr=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}},Tr=class e{constructor(e){this.fields=e,e.sort(R.comparator)}static empty(){return new e([])}unionWith(t){let n=new G(R.comparator);for(let e of this.fields)n=n.add(e);for(let e of t)n=n.add(e);return new e(n.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return zn(this.fields,e.fields,((e,t)=>e.isEqual(t)))}},Er=class extends Error{constructor(){super(...arguments),this.name=`Base64DecodeError`}},Dr=class e{constructor(e){this.binaryString=e}static fromBase64String(t){return new e(function(e){try{return atob(e)}catch(e){throw typeof DOMException<`u`&&e instanceof DOMException?new Er(`Invalid base64 string: `+e):e}}(t))}static fromUint8Array(t){return new e(function(e){let t=``;for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return I(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Dr.EMPTY_BYTE_STRING=new Dr(``);var Or=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kr(e){if(M(!!e,39018),typeof e==`string`){let t=0,n=Or.exec(e);if(M(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+`000000000`).substr(0,9),t=Number(e)}let r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:K(e.seconds),nanos:K(e.nanos)}}function K(e){return typeof e==`number`?e:typeof e==`string`?Number(e):0}function Ar(e){return typeof e==`string`?Dr.fromBase64String(e):Dr.fromUint8Array(e)}var jr=`server_timestamp`,Mr=`__type__`,Nr=`__previous_value__`,Pr=`__local_write_time__`;function Fr(e){return(e?.mapValue?.fields||{})[Mr]?.stringValue===jr}function Ir(e){let t=e.mapValue.fields[Nr];return Fr(t)?Ir(t):t}function Lr(e){let t=kr(e.mapValue.fields[Pr].timestampValue);return new V(t.seconds,t.nanos)}var Rr=class{constructor(e,t,n,r,i,a,o,s,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=s,this.useFetchStreams=c,this.isUsingEmulator=l}},zr=`(default)`,Br=class e{constructor(e,t){this.projectId=e,this.database=t||zr}static empty(){return new e(``,``)}get isDefaultDatabase(){return this.database===zr}isEqual(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}},Vr=`__type__`,Hr=`__max__`,Ur={mapValue:{fields:{__type__:{stringValue:Hr}}}},Wr=`__vector__`,Gr=`value`;function Kr(e){return`nullValue`in e?0:`booleanValue`in e?1:`integerValue`in e||`doubleValue`in e?2:`timestampValue`in e?3:`stringValue`in e?5:`bytesValue`in e?6:`referenceValue`in e?7:`geoPointValue`in e?8:`arrayValue`in e?9:`mapValue`in e?Fr(e)?4:oi(e)?9007199254740991:ii(e)?10:11:j(28295,{value:e})}function qr(e,t){if(e===t)return!0;let n=Kr(e);if(n!==Kr(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Lr(e).isEqual(Lr(t));case 3:return function(e,t){if(typeof e.timestampValue==`string`&&typeof t.timestampValue==`string`&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=kr(e.timestampValue),r=kr(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Ar(e.bytesValue).isEqual(Ar(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return K(e.geoPointValue.latitude)===K(t.geoPointValue.latitude)&&K(e.geoPointValue.longitude)===K(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if(`integerValue`in e&&`integerValue`in t)return K(e.integerValue)===K(t.integerValue);if(`doubleValue`in e&&`doubleValue`in t){let n=K(e.doubleValue),r=K(t.doubleValue);return n===r?pr(n)===pr(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return zn(e.arrayValue.values||[],t.arrayValue.values||[],qr);case 10:case 11:return function(e,t){let n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(yr(n)!==yr(r))return!1;for(let e in n)if(n.hasOwnProperty(e)&&(r[e]===void 0||!qr(n[e],r[e])))return!1;return!0}(e,t);default:return j(52216,{left:e})}}function Jr(e,t){return(e.values||[]).find((e=>qr(e,t)))!==void 0}function Yr(e,t){if(e===t)return 0;let n=Kr(e),r=Kr(t);if(n!==r)return I(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return I(e.booleanValue,t.booleanValue);case 2:return function(e,t){let n=K(e.integerValue||e.doubleValue),r=K(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Xr(e.timestampValue,t.timestampValue);case 4:return Xr(Lr(e),Lr(t));case 5:return Fn(e.stringValue,t.stringValue);case 6:return function(e,t){let n=Ar(e),r=Ar(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){let n=e.split(`/`),r=t.split(`/`);for(let e=0;e<n.length&&e<r.length;e++){let t=I(n[e],r[e]);if(t!==0)return t}return I(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){let n=I(K(e.latitude),K(t.latitude));return n===0?I(K(e.longitude),K(t.longitude)):n}(e.geoPointValue,t.geoPointValue);case 9:return Zr(e.arrayValue,t.arrayValue);case 10:return function(e,t){let n=e.fields||{},r=t.fields||{},i=n[Gr]?.arrayValue,a=r[Gr]?.arrayValue,o=I(i?.values?.length||0,a?.values?.length||0);return o===0?Zr(i,a):o}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Ur.mapValue&&t===Ur.mapValue)return 0;if(e===Ur.mapValue)return 1;if(t===Ur.mapValue)return-1;let n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(let e=0;e<r.length&&e<a.length;++e){let t=Fn(r[e],a[e]);if(t!==0)return t;let o=Yr(n[r[e]],i[a[e]]);if(o!==0)return o}return I(r.length,a.length)}(e.mapValue,t.mapValue);default:throw j(23264,{he:n})}}function Xr(e,t){if(typeof e==`string`&&typeof t==`string`&&e.length===t.length)return I(e,t);let n=kr(e),r=kr(t),i=I(n.seconds,r.seconds);return i===0?I(n.nanos,r.nanos):i}function Zr(e,t){let n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){let t=Yr(n[e],r[e]);if(t)return t}return I(n.length,r.length)}function Qr(e){return $r(e)}function $r(e){return`nullValue`in e?`null`:`booleanValue`in e?``+e.booleanValue:`integerValue`in e?``+e.integerValue:`doubleValue`in e?``+e.doubleValue:`timestampValue`in e?function(e){let t=kr(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):`stringValue`in e?e.stringValue:`bytesValue`in e?function(e){return Ar(e).toBase64()}(e.bytesValue):`referenceValue`in e?function(e){return z.fromName(e).toString()}(e.referenceValue):`geoPointValue`in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):`arrayValue`in e?function(e){let t=`[`,n=!0;for(let r of e.values||[])n?n=!1:t+=`,`,t+=$r(r);return t+`]`}(e.arrayValue):`mapValue`in e?function(e){let t=Object.keys(e.fields||{}).sort(),n=`{`,r=!0;for(let i of t)r?r=!1:n+=`,`,n+=`${i}:${$r(e.fields[i])}`;return n+`}`}(e.mapValue):j(61005,{value:e})}function ei(e){switch(Kr(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let t=Ir(e);return t?16+ei(t):16;case 5:return 2*e.stringValue.length;case 6:return Ar(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+ei(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return br(e.fields,((e,n)=>{t+=e.length+ei(n)})),t}(e.mapValue);default:throw j(13486,{value:e})}}function ti(e){return!!e&&`integerValue`in e}function ni(e){return!!e&&`arrayValue`in e}function ri(e){return!!e&&`mapValue`in e}function ii(e){return(e?.mapValue?.fields||{})[Vr]?.stringValue===Wr}function ai(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&typeof e.timestampValue==`object`)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return br(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=ai(n))),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ai(e.arrayValue.values[n]);return t}return{...e}}function oi(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Hr}var si=class e{constructor(e){this.value=e}static empty(){return new e({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ri(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ai(t)}setAll(e){let t=R.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=ai(e):r.push(i.lastSegment())}));let i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){let t=this.field(e.popLast());ri(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];ri(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){br(t,((t,n)=>e[t]=n));for(let t of n)delete e[t]}clone(){return new e(ai(this.value))}};function ci(e){let t=[];return br(e.fields,((e,n)=>{let r=new R([e]);if(ri(n)){let e=ci(n.mapValue).fields;if(e.length===0)t.push(r);else for(let n of e)t.push(r.child(n))}else t.push(r)})),new Tr(t)}var li=class e{constructor(e,t,n,r,i,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(t){return new e(t,0,H.min(),H.min(),H.min(),si.empty(),0)}static newFoundDocument(t,n,r,i){return new e(t,1,n,H.min(),r,i,0)}static newNoDocument(t,n){return new e(t,2,n,H.min(),H.min(),si.empty(),0)}static newUnknownDocument(t,n){return new e(t,3,n,H.min(),H.min(),si.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(H.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=si.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=si.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=H.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}},ui=class{constructor(e,t){this.position=e,this.inclusive=t}};function di(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){let a=t[i],o=e.position[i];if(r=a.field.isKeyField()?z.comparator(z.fromName(o.referenceValue),n.key):Yr(o,n.data.field(a.field)),a.dir===`desc`&&(r*=-1),r!==0)break}return r}function fi(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!qr(e.position[n],t.position[n]))return!1;return!0}var pi=class{constructor(e,t=`asc`){this.field=e,this.dir=t}};function mi(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var hi=class{},q=class e extends hi{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(t,n,r){return t.isKeyField()?n===`in`||n===`not-in`?this.createKeyFieldInFilter(t,n,r):new Ci(t,n,r):n===`array-contains`?new Di(t,r):n===`in`?new Oi(t,r):n===`not-in`?new ki(t,r):n===`array-contains-any`?new Ai(t,r):new e(t,n,r)}static createKeyFieldInFilter(e,t,n){return t===`in`?new wi(e,n):new Ti(e,n)}matches(e){let t=e.data.field(this.field);return this.op===`!=`?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yr(t,this.value)):t!==null&&Kr(this.value)===Kr(t)&&this.matchesComparison(Yr(t,this.value))}matchesComparison(e){switch(this.op){case`<`:return e<0;case`<=`:return e<=0;case`==`:return e===0;case`!=`:return e!==0;case`>`:return e>0;case`>=`:return e>=0;default:return j(47266,{operator:this.op})}}isInequality(){return[`<`,`<=`,`>`,`>=`,`!=`,`not-in`].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},gi=class e extends hi{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(t,n){return new e(t,n)}matches(e){return _i(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function _i(e){return e.op===`and`}function vi(e){return yi(e)&&_i(e)}function yi(e){for(let t of e.filters)if(t instanceof gi)return!1;return!0}function bi(e){if(e instanceof q)return e.field.canonicalString()+e.op.toString()+Qr(e.value);if(vi(e))return e.filters.map((e=>bi(e))).join(`,`);{let t=e.filters.map((e=>bi(e))).join(`,`);return`${e.op}(${t})`}}function xi(e,t){return e instanceof q?function(e,t){return t instanceof q&&e.op===t.op&&e.field.isEqual(t.field)&&qr(e.value,t.value)}(e,t):e instanceof gi?function(e,t){return t instanceof gi&&e.op===t.op&&e.filters.length===t.filters.length?e.filters.reduce(((e,n,r)=>e&&xi(n,t.filters[r])),!0):!1}(e,t):void j(19439)}function Si(e){return e instanceof q?function(e){return`${e.field.canonicalString()} ${e.op} ${Qr(e.value)}`}(e):e instanceof gi?function(e){return e.op.toString()+` {`+e.getFilters().map(Si).join(` ,`)+`}`}(e):`Filter`}var Ci=class extends q{constructor(e,t,n){super(e,t,n),this.key=z.fromName(n.referenceValue)}matches(e){let t=z.comparator(e.key,this.key);return this.matchesComparison(t)}},wi=class extends q{constructor(e,t){super(e,`in`,t),this.keys=Ei(`in`,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}},Ti=class extends q{constructor(e,t){super(e,`not-in`,t),this.keys=Ei(`not-in`,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}};function Ei(e,t){return(t.arrayValue?.values||[]).map((e=>z.fromName(e.referenceValue)))}var Di=class extends q{constructor(e,t){super(e,`array-contains`,t)}matches(e){let t=e.data.field(this.field);return ni(t)&&Jr(t.arrayValue,this.value)}},Oi=class extends q{constructor(e,t){super(e,`in`,t)}matches(e){let t=e.data.field(this.field);return t!==null&&Jr(this.value.arrayValue,t)}},ki=class extends q{constructor(e,t){super(e,`not-in`,t)}matches(e){if(Jr(this.value.arrayValue,{nullValue:`NULL_VALUE`}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Jr(this.value.arrayValue,t)}},Ai=class extends q{constructor(e,t){super(e,`array-contains-any`,t)}matches(e){let t=e.data.field(this.field);return!(!ni(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Jr(this.value.arrayValue,e)))}},ji=class{constructor(e,t=null,n=[],r=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}};function Mi(e,t=null,n=[],r=[],i=null,a=null,o=null){return new ji(e,t,n,r,i,a,o)}function Ni(e){let t=N(e);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+=`|cg:`+t.collectionGroup),e+=`|f:`,e+=t.filters.map((e=>bi(e))).join(`,`),e+=`|ob:`,e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(`,`),fr(t.limit)||(e+=`|l:`,e+=t.limit),t.startAt&&(e+=`|lb:`,e+=t.startAt.inclusive?`b:`:`a:`,e+=t.startAt.position.map((e=>Qr(e))).join(`,`)),t.endAt&&(e+=`|ub:`,e+=t.endAt.inclusive?`a:`:`b:`,e+=t.endAt.position.map((e=>Qr(e))).join(`,`)),t.Te=e}return t.Te}function Pi(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!mi(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!xi(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!fi(e.startAt,t.startAt)&&fi(e.endAt,t.endAt)}var Fi=class{constructor(e,t=null,n=[],r=[],i=null,a=`F`,o=null,s=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=s,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function Ii(e,t,n,r,i,a,o,s){return new Fi(e,t,n,r,i,a,o,s)}function Li(e){return new Fi(e)}function Ri(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function zi(e){return e.collectionGroup!==null}function Bi(e){let t=N(e);if(t.Ie===null){t.Ie=[];let e=new Set;for(let n of t.explicitOrderBy)t.Ie.push(n),e.add(n.field.canonicalString());let n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:`asc`;(function(e){let t=new G(R.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t})(t).forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new pi(r,n))})),e.has(R.keyField().canonicalString())||t.Ie.push(new pi(R.keyField(),n))}return t.Ie}function Vi(e){let t=N(e);return t.Ee||=Hi(t,Bi(e)),t.Ee}function Hi(e,t){if(e.limitType===`F`)return Mi(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{let t=e.dir===`desc`?`asc`:`desc`;return new pi(e.field,t)}));let n=e.endAt?new ui(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ui(e.startAt.position,e.startAt.inclusive):null;return Mi(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Ui(e,t,n){return new Fi(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Wi(e,t){return Pi(Vi(e),Vi(t))&&e.limitType===t.limitType}function Gi(e){return`${Ni(Vi(e))}|lt:${e.limitType}`}function Ki(e){return`Query(target=${function(e){let t=e.path.canonicalString();return e.collectionGroup!==null&&(t+=` collectionGroup=`+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Si(e))).join(`, `)}]`),fr(e.limit)||(t+=`, limit: `+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(`, `)}]`),e.startAt&&(t+=`, startAt: `,t+=e.startAt.inclusive?`b:`:`a:`,t+=e.startAt.position.map((e=>Qr(e))).join(`,`)),e.endAt&&(t+=`, endAt: `,t+=e.endAt.inclusive?`a:`:`b:`,t+=e.endAt.position.map((e=>Qr(e))).join(`,`)),`Target(${t})`}(Vi(e))}; limitType=${e.limitType})`}function qi(e,t){return t.isFoundDocument()&&function(e,t){let n=t.key.path;return e.collectionGroup===null?z.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n):t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n)}(e,t)&&function(e,t){for(let n of Bi(e))if(!n.field.isKeyField()&&t.data.field(n.field)===null)return!1;return!0}(e,t)&&function(e,t){for(let n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){let r=di(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Bi(e),t)||e.endAt&&!function(e,t,n){let r=di(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Bi(e),t))}(e,t)}function Ji(e){return(t,n)=>{let r=!1;for(let i of Bi(e)){let e=Yi(i,t,n);if(e!==0)return e;r||=i.field.isKeyField()}return 0}}function Yi(e,t,n){let r=e.field.isKeyField()?z.comparator(t.key,n.key):function(e,t,n){let r=t.data.field(e),i=n.data.field(e);return r!==null&&i!==null?Yr(r,i):j(42886)}(e.field,t,n);switch(e.dir){case`asc`:return r;case`desc`:return-1*r;default:return j(19790,{direction:e.dir})}}var Xi=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[t,r]of n)if(this.equalsFn(t,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){br(this.inner,((t,n)=>{for(let[t,r]of n)e(t,r)}))}isEmpty(){return xr(this.inner)}size(){return this.innerSize}},Zi=new W(z.comparator);function Qi(){return Zi}var $i=new W(z.comparator);function ea(...e){let t=$i;for(let n of e)t=t.insert(n.key,n);return t}function ta(e){let t=$i;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function na(){return ia()}function ra(){return ia()}function ia(){return new Xi((e=>e.toString()),((e,t)=>e.isEqual(t)))}var aa=new W(z.comparator),oa=new G(z.comparator);function J(...e){let t=oa;for(let n of e)t=t.add(n);return t}var sa=new G(I);function ca(){return sa}function la(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:`NaN`};if(t===1/0)return{doubleValue:`Infinity`};if(t===-1/0)return{doubleValue:`-Infinity`}}return{doubleValue:pr(t)?`-0`:t}}function ua(e){return{integerValue:``+e}}function da(e,t){return mr(t)?ua(t):la(e,t)}var fa=class{constructor(){this._=void 0}};function pa(e,t,n){return e instanceof ga?function(e,t){let n={fields:{[Mr]:{stringValue:jr},[Pr]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Fr(t)&&(t=Ir(t)),t&&(n.fields[Nr]=t),{mapValue:n}}(n,t):e instanceof _a?va(e,t):e instanceof ya?ba(e,t):function(e,t){let n=ha(e,t),r=Sa(n)+Sa(e.Ae);return ti(n)&&ti(e.Ae)?ua(r):la(e.serializer,r)}(e,t)}function ma(e,t,n){return e instanceof _a?va(e,t):e instanceof ya?ba(e,t):n}function ha(e,t){return e instanceof xa?function(e){return ti(e)||function(e){return!!e&&`doubleValue`in e}(e)}(t)?t:{integerValue:0}:null}var ga=class extends fa{},_a=class extends fa{constructor(e){super(),this.elements=e}};function va(e,t){let n=Ca(t);for(let t of e.elements)n.some((e=>qr(e,t)))||n.push(t);return{arrayValue:{values:n}}}var ya=class extends fa{constructor(e){super(),this.elements=e}};function ba(e,t){let n=Ca(t);for(let t of e.elements)n=n.filter((e=>!qr(e,t)));return{arrayValue:{values:n}}}var xa=class extends fa{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function Sa(e){return K(e.integerValue||e.doubleValue)}function Ca(e){return ni(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function wa(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof _a&&t instanceof _a||e instanceof ya&&t instanceof ya?zn(e.elements,t.elements,qr):e instanceof xa&&t instanceof xa?qr(e.Ae,t.Ae):e instanceof ga&&t instanceof ga}(e.transform,t.transform)}var Ta=class{constructor(e,t){this.version=e,this.transformResults=t}},Ea=class e{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new e}static exists(t){return new e(void 0,t)}static updateTime(t){return new e(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Da(e,t){return e.updateTime===void 0?e.exists===void 0||e.exists===t.isFoundDocument():t.isFoundDocument()&&t.version.isEqual(e.updateTime)}var Oa=class{};function ka(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new za(e.key,Ea.none()):new Pa(e.key,e.data,Ea.none());{let n=e.data,r=si.empty(),i=new G(R.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);t===null&&e.length>1&&(e=e.popLast(),t=n.field(e)),t===null?r.delete(e):r.set(e,t),i=i.add(e)}return new Fa(e.key,r,new Tr(i.toArray()),Ea.none())}}function Aa(e,t,n){e instanceof Pa?function(e,t,n){let r=e.value.clone(),i=La(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Fa?function(e,t,n){if(!Da(e.precondition,t))return void t.convertToUnknownDocument(n.version);let r=La(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Ia(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function ja(e,t,n,r){return e instanceof Pa?function(e,t,n,r){if(!Da(e.precondition,t))return n;let i=e.value.clone(),a=Ra(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Fa?function(e,t,n,r){if(!Da(e.precondition,t))return n;let i=Ra(e.fieldTransforms,r,t),a=t.data;return a.setAll(Ia(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),n===null?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Da(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Ma(e,t){let n=null;for(let r of e.fieldTransforms){let e=t.data.field(r.field),i=ha(r.transform,e||null);i!=null&&(n===null&&(n=si.empty()),n.set(r.field,i))}return n||null}function Na(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return e===void 0&&t===void 0||!(!e||!t)&&zn(e,t,((e,t)=>wa(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var Pa=class extends Oa{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},Fa=class extends Oa{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}};function Ia(e){let t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){let r=e.data.field(n);t.set(n,r)}})),t}function La(e,t,n){let r=new Map;M(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){let a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,ma(o,s,n[i]))}return r}function Ra(e,t,n){let r=new Map;for(let i of e){let e=i.transform,a=n.data.field(i.field);r.set(i.field,pa(e,a,t))}return r}var za=class extends Oa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ba=class extends Oa{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}},Va=class{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let r=this.mutations[t];r.key.isEqual(e.key)&&Aa(r,e,n[t])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=ja(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=ja(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=ra();return this.mutations.forEach((r=>{let i=e.get(r.key),a=i.overlayedDocument,o=this.applyToLocalView(a,i.mutatedFields);o=t.has(r.key)?null:o;let s=ka(a,o);s!==null&&n.set(r.key,s),a.isValidDocument()||a.convertToNoDocument(H.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),J())}isEqual(e){return this.batchId===e.batchId&&zn(this.mutations,e.mutations,((e,t)=>Na(e,t)))&&zn(this.baseMutations,e.baseMutations,((e,t)=>Na(e,t)))}},Ha=class e{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(t,n,r){M(t.mutations.length===r.length,58842,{me:t.mutations.length,fe:r.length});let i=function(){return aa}(),a=t.mutations;for(let e=0;e<a.length;e++)i=i.insert(a[e].key,r[e].version);return new e(t,n,r,i)}},Ua=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}},Y,X;function Wa(e){switch(e){case P.OK:return j(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return j(15467,{code:e})}}function Ga(e){if(e===void 0)return A(`GRPC error has no .code`),P.UNKNOWN;switch(e){case Y.OK:return P.OK;case Y.CANCELLED:return P.CANCELLED;case Y.UNKNOWN:return P.UNKNOWN;case Y.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case Y.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case Y.INTERNAL:return P.INTERNAL;case Y.UNAVAILABLE:return P.UNAVAILABLE;case Y.UNAUTHENTICATED:return P.UNAUTHENTICATED;case Y.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case Y.NOT_FOUND:return P.NOT_FOUND;case Y.ALREADY_EXISTS:return P.ALREADY_EXISTS;case Y.PERMISSION_DENIED:return P.PERMISSION_DENIED;case Y.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case Y.ABORTED:return P.ABORTED;case Y.OUT_OF_RANGE:return P.OUT_OF_RANGE;case Y.UNIMPLEMENTED:return P.UNIMPLEMENTED;case Y.DATA_LOSS:return P.DATA_LOSS;default:return j(39323,{code:e})}}(X=Y||={})[X.OK=0]=`OK`,X[X.CANCELLED=1]=`CANCELLED`,X[X.UNKNOWN=2]=`UNKNOWN`,X[X.INVALID_ARGUMENT=3]=`INVALID_ARGUMENT`,X[X.DEADLINE_EXCEEDED=4]=`DEADLINE_EXCEEDED`,X[X.NOT_FOUND=5]=`NOT_FOUND`,X[X.ALREADY_EXISTS=6]=`ALREADY_EXISTS`,X[X.PERMISSION_DENIED=7]=`PERMISSION_DENIED`,X[X.UNAUTHENTICATED=16]=`UNAUTHENTICATED`,X[X.RESOURCE_EXHAUSTED=8]=`RESOURCE_EXHAUSTED`,X[X.FAILED_PRECONDITION=9]=`FAILED_PRECONDITION`,X[X.ABORTED=10]=`ABORTED`,X[X.OUT_OF_RANGE=11]=`OUT_OF_RANGE`,X[X.UNIMPLEMENTED=12]=`UNIMPLEMENTED`,X[X.INTERNAL=13]=`INTERNAL`,X[X.UNAVAILABLE=14]=`UNAVAILABLE`,X[X.DATA_LOSS=15]=`DATA_LOSS`,new on([4294967295,4294967295],0);var Ka=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function qa(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,``).replace(`Z`,``)}.${(`000000000`+t.nanoseconds).slice(-9)}Z`:{seconds:``+t.seconds,nanos:t.nanoseconds}}function Ja(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ya(e,t){return qa(e,t.toTimestamp())}function Xa(e){return M(!!e,49232),H.fromTimestamp(function(e){let t=kr(e);return new V(t.seconds,t.nanos)}(e))}function Za(e,t){return Qa(e,t).canonicalString()}function Qa(e,t){let n=function(e){return new L([`projects`,e.projectId,`databases`,e.database])}(e).child(`documents`);return t===void 0?n:n.child(t)}function $a(e){let t=L.fromString(e);return M(fo(t),10190,{key:t.toString()}),t}function eo(e,t){return Za(e.databaseId,t.path)}function to(e){let t=$a(e);return t.length===4?L.emptyPath():ro(t)}function no(e){return new L([`projects`,e.databaseId.projectId,`databases`,e.databaseId.database]).canonicalString()}function ro(e){return M(e.length>4&&e.get(4)===`documents`,29091,{key:e.toString()}),e.popFirst(5)}function io(e,t,n){return{name:eo(e,t),fields:n.value.mapValue.fields}}function ao(e,t){let n;if(t instanceof Pa)n={update:io(e,t.key,t.value)};else if(t instanceof za)n={delete:eo(e,t.key)};else if(t instanceof Fa)n={update:io(e,t.key,t.data),updateMask:uo(t.fieldMask)};else{if(!(t instanceof Ba))return j(16599,{Vt:t.type});n={verify:eo(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){let n=t.transform;if(n instanceof ga)return{fieldPath:t.field.canonicalString(),setToServerValue:`REQUEST_TIME`};if(n instanceof _a)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ya)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof xa)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw j(20930,{transform:t.transform})}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return t.updateTime===void 0?t.exists===void 0?j(27497):{exists:t.exists}:{updateTime:Ya(e,t.updateTime)}}(e,t.precondition)),n}function oo(e,t){return e&&e.length>0?(M(t!==void 0,14353),e.map((e=>function(e,t){let n=e.updateTime?Xa(e.updateTime):Xa(t);return n.isEqual(H.min())&&(n=Xa(t)),new Ta(n,e.transformResults||[])}(e,t)))):[]}function so(e){let t=to(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){M(r===1,65062);let e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){let t=co(e);return t instanceof gi&&vi(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new pi(lo(e.field),function(e){switch(e){case`ASCENDING`:return`asc`;case`DESCENDING`:return`desc`;default:return}}(e.direction))}(e)))}(n.orderBy));let s=null;n.limit&&(s=function(e){let t;return t=typeof e==`object`?e.value:e,fr(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){let t=!!e.before;return new ui(e.values||[],t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){let t=!e.before;return new ui(e.values||[],t)}(n.endAt)),Ii(t,i,o,a,s,`F`,c,l)}function co(e){return e.unaryFilter===void 0?e.fieldFilter===void 0?e.compositeFilter===void 0?j(30097,{filter:e}):function(e){return gi.create(e.compositeFilter.filters.map((e=>co(e))),function(e){switch(e){case`AND`:return`and`;case`OR`:return`or`;default:return j(1026)}}(e.compositeFilter.op))}(e):function(e){return q.create(lo(e.fieldFilter.field),function(e){switch(e){case`EQUAL`:return`==`;case`NOT_EQUAL`:return`!=`;case`GREATER_THAN`:return`>`;case`GREATER_THAN_OR_EQUAL`:return`>=`;case`LESS_THAN`:return`<`;case`LESS_THAN_OR_EQUAL`:return`<=`;case`ARRAY_CONTAINS`:return`array-contains`;case`IN`:return`in`;case`NOT_IN`:return`not-in`;case`ARRAY_CONTAINS_ANY`:return`array-contains-any`;case`OPERATOR_UNSPECIFIED`:return j(58110);default:return j(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):function(e){switch(e.unaryFilter.op){case`IS_NAN`:let t=lo(e.unaryFilter.field);return q.create(t,`==`,{doubleValue:NaN});case`IS_NULL`:let n=lo(e.unaryFilter.field);return q.create(n,`==`,{nullValue:`NULL_VALUE`});case`IS_NOT_NAN`:let r=lo(e.unaryFilter.field);return q.create(r,`!=`,{doubleValue:NaN});case`IS_NOT_NULL`:let i=lo(e.unaryFilter.field);return q.create(i,`!=`,{nullValue:`NULL_VALUE`});case`OPERATOR_UNSPECIFIED`:return j(61313);default:return j(60726)}}(e)}function lo(e){return R.fromServerFormat(e.fieldPath)}function uo(e){let t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function fo(e){return e.length>=4&&e.get(0)===`projects`&&e.get(2)===`databases`}var po=class{constructor(e){this.yt=e}};function mo(e){let t=so({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType===`LAST`?Ui(t,t.limit,`L`):t}var ho=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if(`nullValue`in e)this.Ft(t,5);else if(`booleanValue`in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if(`integerValue`in e)this.Ft(t,15),t.Mt(K(e.integerValue));else if(`doubleValue`in e){let n=K(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),pr(n)?t.Mt(0):t.Mt(n))}else if(`timestampValue`in e){let n=e.timestampValue;this.Ft(t,20),typeof n==`string`&&(n=kr(n)),t.xt(`${n.seconds||``}`),t.Mt(n.nanos||0)}else if(`stringValue`in e)this.Ot(e.stringValue,t),this.Nt(t);else if(`bytesValue`in e)this.Ft(t,30),t.Bt(Ar(e.bytesValue)),this.Nt(t);else if(`referenceValue`in e)this.Lt(e.referenceValue,t);else if(`geoPointValue`in e){let n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else `mapValue`in e?oi(e)?this.Ft(t,2**53-1):ii(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):`arrayValue`in e?(this.Qt(e.arrayValue,t),this.Nt(t)):j(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let n=e.fields||{};this.Ft(t,55);for(let e of Object.keys(n))this.Ot(e,t),this.Ct(n[e],t)}kt(e,t){let n=e.fields||{};this.Ft(t,53);let r=Gr,i=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(K(i)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){let n=e.values||[];this.Ft(t,50);for(let e of n)this.Ct(e,t)}Lt(e,t){this.Ft(t,37),z.fromName(e).path.forEach((e=>{this.Ft(t,60),this.Ut(e,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};ho.Kt=new ho;var go=class{constructor(){this.Cn=new _o}addToCollectionParentIndex(e,t){return this.Cn.add(t),U.resolve()}getCollectionParents(e,t){return U.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return U.resolve()}deleteFieldIndex(e,t){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,t){return U.resolve()}getDocumentsMatchingTarget(e,t){return U.resolve(null)}getIndexType(e,t){return U.resolve(0)}getFieldIndexes(e,t){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,t){return U.resolve(rr.min())}getMinOffsetFromCollectionGroup(e,t){return U.resolve(rr.min())}updateCollectionGroup(e,t,n){return U.resolve()}updateIndexEntries(e,t){return U.resolve()}},_o=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new G(L.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new G(L.comparator)).toArray()}};new Uint8Array;var vo={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},yo=41943040,bo=class e{static withCacheSize(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}};bo.DEFAULT_COLLECTION_PERCENTILE=10,bo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bo.DEFAULT=new bo(yo,bo.DEFAULT_COLLECTION_PERCENTILE,bo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bo.DISABLED=new bo(-1,0,0);var xo=class e{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new e(0)}static cr(){return new e(-1)}},So=`LruGarbageCollector`,Co=1048576;function wo([e,t],[n,r]){let i=I(e,n);return i===0?I(t,r):i}var To=class{constructor(e){this.Ir=e,this.buffer=new G(wo),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();wo(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}},Eo=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&=(this.Rr.cancel(),null)}get started(){return this.Rr!==null}Vr(e){k(So,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay(`lru_garbage_collection`,e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){lr(e)?k(So,`Ignoring IndexedDB error during garbage collection: `,e):await sr(e)}await this.Vr(3e5)}))}},Do=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(t===0)return U.resolve(ur.ce);let n=new To(t);return this.mr.forEachTarget(e,(e=>n.Ar(e.sequenceNumber))).next((()=>this.mr.pr(e,(e=>n.Ar(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k(`LruGarbageCollector`,`Garbage collection skipped; disabled`),U.resolve(vo)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(k(`LruGarbageCollector`,`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),vo):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,a,o,s,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(k(`LruGarbageCollector`,`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,s=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),bn()<=b.DEBUG&&k(`LruGarbageCollector`,`LRU Garbage Collection\n\tCounted targets in ${a-l}ms\n\tDetermined least recently used ${r} in `+(o-a)+`ms
\tRemoved ${i} targets in `+(s-o)+`ms
\tRemoved ${e} documents in `+(c-s)+`ms
Total Duration: ${c-l}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}};function Oo(e,t){return new Do(e,t)}var ko=class{constructor(){this.changes=new Xi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,li.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n===void 0?this.getFromCache(e,t):U.resolve(n)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}},Ao=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}},jo=class{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(n!==null&&ja(n.mutation,e,Tr.empty(),V.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,J()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=J()){let r=na();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=ea();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){let n=na();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,J())))}populateOverlays(e,t,n){let r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Qi(),a=ia(),o=function(){return ia()}();return t.forEach(((e,t)=>{let o=n.get(t.key);r.has(t.key)&&(o===void 0||o.mutation instanceof Fa)?i=i.insert(t.key,t):o===void 0?a.set(t.key,Tr.empty()):(a.set(t.key,o.mutation.getFieldMask()),ja(o.mutation,t,o.mutation.getFieldMask(),V.now()))})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>a.set(e,t))),t.forEach(((e,t)=>o.set(e,new Ao(t,a.get(e)??null)))),o)))}recalculateAndSaveOverlays(e,t){let n=ia(),r=new W(((e,t)=>e-t)),i=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(let i of e)i.keys().forEach((e=>{let a=t.get(e);if(a===null)return;let o=n.get(e)||Tr.empty();o=i.applyToLocalView(a,o),n.set(e,o);let s=(r.get(i.batchId)||J()).add(e);r=r.insert(i.batchId,s)}))})).next((()=>{let a=[],o=r.getReverseIterator();for(;o.hasNext();){let r=o.getNext(),s=r.key,c=r.value,l=ra();c.forEach((e=>{if(!i.has(e)){let r=ka(t.get(e),n.get(e));r!==null&&l.set(e,r),i=i.add(e)}})),a.push(this.documentOverlayCache.saveOverlays(e,s,l))}return U.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return z.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):zi(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{let a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):U.resolve(na()),o=$n,s=i;return a.next((t=>U.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?U.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{s=s.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,s,t,J()))).next((e=>({batchId:o,changes:ta(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new z(t)).next((e=>{let t=ea();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){let i=t.collectionGroup,a=ea();return this.indexManager.getCollectionParents(e,i).next((o=>U.forEach(o,(o=>{let s=function(e,t){return new Fi(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,s,n,r).next((e=>{e.forEach(((e,t)=>{a=a.insert(e,t)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{let r=n.getKey();e.get(r)===null&&(e=e.insert(r,li.newInvalidDocument(r)))}));let n=ea();return e.forEach(((e,r)=>{let a=i.get(e);a!==void 0&&ja(a.mutation,r,Tr.empty(),V.now()),qi(t,r)&&(n=n.insert(e,r))})),n}))}},Mo=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return U.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Xa(e.createTime)}}(t)),U.resolve()}getNamedQuery(e,t){return U.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:mo(e.bundledQuery),readTime:Xa(e.readTime)}}(t)),U.resolve()}},No=class{constructor(){this.overlays=new W(z.comparator),this.qr=new Map}getOverlay(e,t){return U.resolve(this.overlays.get(t))}getOverlays(e,t){let n=na();return U.forEach(t,(t=>this.getOverlay(e,t).next((e=>{e!==null&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.St(e,t,r)})),U.resolve()}removeOverlaysForBatchId(e,t,n){let r=this.qr.get(n);return r!==void 0&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.qr.delete(n)),U.resolve()}getOverlaysForCollection(e,t,n){let r=na(),i=t.length+1,a=new z(t.child(``)),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){let e=o.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return U.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new W(((e,t)=>e-t)),a=this.overlays.getIterator();for(;a.hasNext();){let e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);t===null&&(t=na(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let o=na(),s=i.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return U.resolve(o)}St(e,t,n){let r=this.overlays.get(n.key);if(r!==null){let e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Ua(t,n));let i=this.qr.get(t);i===void 0&&(i=J(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}},Po=class{constructor(){this.sessionToken=Dr.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,U.resolve()}},Fo=class{constructor(){this.Qr=new G(Z.$r),this.Ur=new G(Z.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let n=new Z(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Gr(new Z(e,t))}zr(e,t){e.forEach((e=>this.removeReference(e,t)))}jr(e){let t=new z(new L([])),n=new Z(t,e),r=new Z(t,e+1),i=[];return this.Ur.forEachInRange([n,r],(e=>{this.Gr(e),i.push(e.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new z(new L([])),n=new Z(t,e),r=new Z(t,e+1),i=J();return this.Ur.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){let t=new Z(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},Z=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return z.comparator(e.key,t.key)||I(e.Yr,t.Yr)}static Kr(e,t){return I(e.Yr,t.Yr)||z.comparator(e.key,t.key)}},Io=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new G(Z.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){let i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Va(i,t,n,r);this.mutationQueue.push(a);for(let t of r)this.Zr=this.Zr.add(new Z(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return U.resolve(a)}lookupMutationBatch(e,t){return U.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=this.ei(n),i=r<0?0:r;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?dr:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new Z(t,0),r=new Z(t,1/0),i=[];return this.Zr.forEachInRange([n,r],(e=>{let t=this.Xr(e.Yr);i.push(t)})),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new G(I);return t.forEach((e=>{let t=new Z(e,0),r=new Z(e,1/0);this.Zr.forEachInRange([t,r],(e=>{n=n.add(e.Yr)}))})),U.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,i=n;z.isDocumentKey(i)||(i=i.child(``));let a=new Z(new z(i),0),o=new G(I);return this.Zr.forEachWhile((e=>{let t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)}),a),U.resolve(this.ti(o))}ti(e){let t=[];return e.forEach((e=>{let n=this.Xr(e);n!==null&&t.push(n)})),t}removeMutationBatch(e,t){M(this.ni(t.batchId,`removed`)===0,55003),this.mutationQueue.shift();let n=this.Zr;return U.forEach(t.mutations,(r=>{let i=new Z(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){let n=new Z(t,0),r=this.Zr.firstAfterOrEqual(n);return U.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}},Lo=class{constructor(e){this.ri=e,this.docs=function(){return new W(z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return U.resolve(n?n.document.mutableCopy():li.newInvalidDocument(t))}getEntries(e,t){let n=Qi();return t.forEach((e=>{let t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():li.newInvalidDocument(e))})),U.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Qi(),a=t.path,o=new z(a.child(`__id-9223372036854775808__`)),s=this.docs.getIteratorFrom(o);for(;s.hasNext();){let{key:e,value:{document:o}}=s.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||ir(nr(o),n)<=0||(r.has(o.key)||qi(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,t,n,r){j(9500)}ii(e,t){return U.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Ro(this)}getSize(e){return U.resolve(this.size)}},Ro=class extends ko{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)})),U.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}},zo=class{constructor(e){this.persistence=e,this.si=new Xi((e=>Ni(e)),Pi),this.lastRemoteSnapshotVersion=H.min(),this.highestTargetId=0,this.oi=0,this._i=new Fo,this.targetCount=0,this.ai=xo.ur()}forEachTarget(e,t){return this.si.forEach(((e,n)=>t(n))),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),U.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new xo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,U.resolve()}updateTargetData(e,t){return this.Pr(t),U.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),--this.targetCount,U.resolve()}removeTargets(e,t,n){let r=0,i=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),U.waitFor(i).next((()=>r))}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,t){let n=this.si.get(t)||null;return U.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),U.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);let r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),U.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),U.resolve()}getMatchingKeysForTargetId(e,t){let n=this._i.Hr(t);return U.resolve(n)}containsKey(e,t){return U.resolve(this._i.containsKey(t))}},Bo=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new ur(0),this.li=!1,this.li=!0,this.hi=new Po,this.referenceDelegate=e(this),this.Pi=new zo(this),this.indexManager=new go,this.remoteDocumentCache=function(e){return new Lo(e)}((e=>this.referenceDelegate.Ti(e))),this.serializer=new po(t),this.Ii=new Mo(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new No,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Io(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){k(`MemoryPersistence`,`Starting transaction:`,e);let r=new Vo(this.ci.next());return this.referenceDelegate.Ei(),n(r).next((e=>this.referenceDelegate.di(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ai(e,t){return U.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}},Vo=class extends or{constructor(e){super(),this.currentSequenceNumber=e}},Ho=class e{constructor(e){this.persistence=e,this.Ri=new Fo,this.Vi=null}static mi(t){return new e(t)}get fi(){if(this.Vi)return this.Vi;throw j(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),U.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),U.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),U.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((e=>this.fi.add(e.toString())));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.fi.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,(n=>{let r=z.fromPath(n);return this.gi(e,r).next((e=>{e||t.removeEntry(r,H.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return U.or([()=>U.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},Uo=class e{constructor(e,t){this.persistence=e,this.pi=new Xi((e=>gr(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=Oo(this,t)}static mi(t,n){return new e(t,n)}Ei(){}di(e){return U.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}wr(e){let t=0;return this.pr(e,(e=>{t++})).next((()=>t))}pr(e,t){return U.forEach(this.pi,((n,r)=>this.br(e,n,r).next((e=>e?U.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0,r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,(r=>this.br(e,r,t).next((e=>{e||(n++,i.removeEntry(r,H.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),U.resolve()}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),U.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ei(e.data.value)),t}br(e,t,n){return U.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.pi.get(t);return U.resolve(e!==void 0&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}},Wo=class e{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(t,n){let r=J(),i=J();for(let e of n.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new e(t,n.fromCache,r,i)}},Go=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}},Ko=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return y()?8:cr(se())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){let i={result:null};return this.ys(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ws(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;let n=new Go;return this.Ss(e,t,n).next((r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)}))})).next((()=>i.result))}bs(e,t,n,r){return n.documentReadCount<this.fs?(bn()<=b.DEBUG&&k(`QueryEngine`,`SDK will not create cache indexes for query:`,Ki(t),`since it only creates cache indexes for collection contains`,`more than or equal to`,this.fs,`documents`),U.resolve()):(bn()<=b.DEBUG&&k(`QueryEngine`,`Query:`,Ki(t),`scans`,n.documentReadCount,`local documents and returns`,r,`documents as results.`),n.documentReadCount>this.gs*r?(bn()<=b.DEBUG&&k(`QueryEngine`,`The SDK decides to create cache indexes for query:`,Ki(t),`as using cache indexes may help improve performance.`),this.indexManager.createTargetIndexes(e,Vi(t))):U.resolve())}ys(e,t){if(Ri(t))return U.resolve(null);let n=Vi(t);return this.indexManager.getIndexType(e,n).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=Ui(t,null,`F`),n=Vi(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{let i=J(...r);return this.ps.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{let a=this.Ds(t,r);return this.Cs(t,a,i,n.readTime)?this.ys(e,Ui(t,null,`F`)):this.vs(e,a,t,n)}))))})))))}ws(e,t,n,r){return Ri(t)||r.isEqual(H.min())?U.resolve(null):this.ps.getDocuments(e,n).next((i=>{let a=this.Ds(t,i);return this.Cs(t,a,n,r)?U.resolve(null):(bn()<=b.DEBUG&&k(`QueryEngine`,`Re-using previous result from %s to execute query: %s`,r.toString(),Ki(t)),this.vs(e,a,t,tr(r,$n)).next((e=>e)))}))}Ds(e,t){let n=new G(Ji(e));return t.forEach(((t,r)=>{qi(e,r)&&(n=n.add(r))})),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let i=e.limitType===`F`?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return bn()<=b.DEBUG&&k(`QueryEngine`,`Using full collection scan to execute query:`,Ki(t)),this.ps.getDocumentsMatchingQuery(e,t,rr.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}},qo=`LocalStore`,Jo=class{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new W(I),this.xs=new Xi((e=>Ni(e)),Pi),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jo(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction(`Collect garbage`,`readwrite-primary`,(t=>e.collect(t,this.Ms)))}};function Yo(e,t,n,r){return new Jo(e,t,n,r)}async function Xo(e,t){let n=N(e);return await n.persistence.runTransaction(`Handle user change`,`readonly`,(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{let i=[],a=[],o=J();for(let e of r){i.push(e.batchId);for(let t of e.mutations)o=o.add(t.key)}for(let e of t){a.push(e.batchId);for(let t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({Ls:e,removedBatchIds:i,addedBatchIds:a})))}))}))}function Zo(e,t){let n=N(e);return n.persistence.runTransaction(`Acknowledge batch`,`readwrite-primary`,(e=>{let r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){let i=n.batch,a=i.keys(),o=U.resolve();return a.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{let a=n.docVersions.get(e);M(a!==null,48541),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=J();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}function Qo(e){let t=N(e);return t.persistence.runTransaction(`Get last remote snapshot version`,`readonly`,(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function $o(e,t){let n=N(e);return n.persistence.runTransaction(`Get next mutation batch`,`readonly`,(e=>(t===void 0&&(t=dr),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}var es=class{constructor(){this.activeTargetIds=ca()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},ts=class{constructor(){this.Mo=new es,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||`not-current`}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new es,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}},ns=class{Oo(e){}shutdown(){}},rs=`ConnectivityMonitor`,is=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener(`online`,this.No),window.removeEventListener(`offline`,this.Lo)}Qo(){window.addEventListener(`online`,this.No),window.addEventListener(`offline`,this.Lo)}Bo(){k(rs,`Network connectivity changed: AVAILABLE`);for(let e of this.qo)e(0)}ko(){k(rs,`Network connectivity changed: UNAVAILABLE`);for(let e of this.qo)e(1)}static v(){return typeof window<`u`&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}},as=null;function os(){return as===null?as=function(){return 268435456+Math.round(2147483648*Math.random())}():as++,`0x`+as.toString(16)}var ss=`RestConnection`,cs={BatchGetDocuments:`batchGet`,Commit:`commit`,RunQuery:`runQuery`,RunAggregationQuery:`runAggregationQuery`},ls=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?`https`:`http`,n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+`://`+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===zr?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){let a=os(),o=this.zo(e,t.toUriEncodedString());k(ss,`Sending RPC '${e}' ${a}:`,o,n);let s={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(s,r,i);let{host:c}=new URL(o),l=ee(c);return this.Jo(e,o,s,n,l).then((t=>(k(ss,`Received RPC '${e}' ${a}: `,t),t)),(t=>{throw xn(ss,`RPC '${e}' ${a} failed with error: `,t,`url: `,o,`request:`,n),t}))}Ho(e,t,n,r,i,a){return this.Go(e,t,n,r,i)}jo(e,t,n){e[`X-Goog-Api-Client`]=function(){return`gl-js/ fire/`+yn}(),e[`Content-Type`]=`text/plain`,this.databaseInfo.appId&&(e[`X-Firebase-GMPID`]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}zo(e,t){let n=cs[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}},us=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}},Q=`WebChannelConnection`,ds=class extends ls{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){let a=os();return new Promise(((i,o)=>{let s=new ln;s.setWithCredentials(!0),s.listenOnce(dn.COMPLETE,(()=>{try{switch(s.getLastErrorCode()){case fn.NO_ERROR:let t=s.getResponseJson();k(Q,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(t)),i(t);break;case fn.TIMEOUT:k(Q,`RPC '${e}' ${a} timed out`),o(new F(P.DEADLINE_EXCEEDED,`Request time out`));break;case fn.HTTP_ERROR:let n=s.getStatus();if(k(Q,`RPC '${e}' ${a} failed with status:`,n,`response text:`,s.getResponseText()),n>0){let e=s.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=e?.error;t&&t.status&&t.message?o(new F(function(e){let t=e.toLowerCase().replace(/_/g,`-`);return Object.values(P).indexOf(t)>=0?t:P.UNKNOWN}(t.status),t.message)):o(new F(P.UNKNOWN,`Server responded with status `+s.getStatus()))}else o(new F(P.UNAVAILABLE,`Connection failed.`));break;default:j(9055,{l_:e,streamId:a,h_:s.getLastErrorCode(),P_:s.getLastError()})}}finally{k(Q,`RPC '${e}' ${a} completed.`)}}));let c=JSON.stringify(r);k(Q,`RPC '${e}' ${a} sending request:`,r),s.send(t,`POST`,c,n,15)}))}T_(e,t,n){let r=os(),i=[this.Uo,`/`,`google.firestore.v1.Firestore`,`/`,e,`/channel`],a=gn(),o=hn(),s={httpSessionIdParam:`gsessionid`,initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(s.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(s.useFetchStreams=!0),this.jo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;let l=i.join(``);k(Q,`Creating RPC '${e}' stream ${r}: ${l}`,s);let u=a.createWebChannel(l,s);this.I_(u);let d=!1,f=!1,p=new us({Yo:t=>{f?k(Q,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||=(k(Q,`Opening RPC '${e}' stream ${r} transport.`),u.open(),!0),k(Q,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Zo:()=>u.close()}),m=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return m(u,un.EventType.OPEN,(()=>{f||(k(Q,`RPC '${e}' stream ${r} transport opened.`),p.o_())})),m(u,un.EventType.CLOSE,(()=>{f||(f=!0,k(Q,`RPC '${e}' stream ${r} transport closed`),p.a_(),this.E_(u))})),m(u,un.EventType.ERROR,(t=>{f||(f=!0,xn(Q,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,`Message:`,t.message),p.a_(new F(P.UNAVAILABLE,`The operation could not be completed`)))})),m(u,un.EventType.MESSAGE,(t=>{if(!f){let n=t.data[0];M(!!n,16349);let i=n,a=i?.error||i[0]?.error;if(a){k(Q,`RPC '${e}' stream ${r} received error:`,a);let t=a.status,n=function(e){let t=Y[e];if(t!==void 0)return Ga(t)}(t),i=a.message;n===void 0&&(n=P.INTERNAL,i=`Unknown error status: `+t+` with message `+a.message),f=!0,p.a_(new F(n,i)),u.close()}else k(Q,`RPC '${e}' stream ${r} received:`,n),p.u_(n)}})),m(o,mn.STAT_EVENT,(t=>{t.stat===pn.PROXY?k(Q,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===pn.NOPROXY&&k(Q,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.__()}),0),p}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}};function fs(){return typeof document<`u`?document:null}function ps(e){return new Ka(e,!0)}var ms=class{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&k(`ExponentialBackoff`,`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}},hs=`PersistentStream`,gs=class{constructor(e,t,n,r,i,a,o,s){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=s,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ms(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state===4?this.N_():this.auth()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&=(this.C_.cancel(),null)}U_(){this.v_&&=(this.v_.cancel(),null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e===4?t&&t.code===P.RESOURCE_EXHAUSTED?(A(t.toString()),A(`Using maximum backoff delay to prevent overloading the backend.`),this.M_.g_()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()):this.M_.reset(),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.D_===t&&this.G_(e,n)}),(t=>{e((()=>{let e=new F(P.UNKNOWN,`Fetching auth token failed: `+t.message);return this.z_(e)}))}))}G_(e,t){let n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((e=>{n((()=>this.z_(e)))})),this.stream.onMessage((e=>{n((()=>++this.F_==1?this.J_(e):this.onNext(e)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return k(hs,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(k(hs,`stream callback skipped by getCloseGuardedDispatcher.`),Promise.resolve())))}}},_s=class extends gs{constructor(e,t,n,r,i,a){super(e,`write_stream_connection_backoff`,`write_stream_idle`,`health_check_timeout`,t,n,r,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_(`Write`,e,t)}J_(e){return M(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,M(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){M(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=oo(e.writeResults,e.commitTime),n=Xa(e.commitTime);return this.listener.na(n,t)}ra(){let e={};e.database=no(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map((e=>ao(this.serializer,e)))};this.q_(t)}},vs=class{},ys=class extends vs{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new F(P.FAILED_PRECONDITION,`The client has already been terminated.`)}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,Qa(t,n),r,i,a))).catch((e=>{throw e.name===`FirebaseError`?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new F(P.UNKNOWN,e.toString())}))}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,Qa(t,n),r,a,o,i))).catch((e=>{throw e.name===`FirebaseError`?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new F(P.UNKNOWN,e.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}},bs=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=`Unknown`,this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca(`Unknown`),this._a=this.asyncQueue.enqueueAfterDelay(`online_state_timeout`,1e4,(()=>(this._a=null,this.la(`Backend didn't respond within 10 seconds.`),this.ca(`Offline`),Promise.resolve()))))}ha(e){this.state===`Online`?this.ca(`Unknown`):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca(`Offline`)))}set(e){this.Pa(),this.oa=0,e===`Online`&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(A(t),this.aa=!1):k(`OnlineStateTracker`,t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}},xs=`RemoteStore`,Ss=class{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((e=>{n.enqueueAndForget((async()=>{Ts(this)&&(k(xs,`Restarting streams for network reachability change.`),await async function(e){let t=N(e);t.Ea.add(4),await ws(t),t.Ra.set(`Unknown`),t.Ea.delete(4),await Cs(t)}(this))}))})),this.Ra=new bs(n,r)}};async function Cs(e){if(Ts(e))for(let t of e.da)await t(!0)}async function ws(e){for(let t of e.da)await t(!1)}function Ts(e){return N(e).Ea.size===0}async function Es(e,t,n){if(!lr(t))throw t;e.Ea.add(1),await ws(e),e.Ra.set(`Offline`),n||=()=>Qo(e.localStore),e.asyncQueue.enqueueRetryable((async()=>{k(xs,`Retrying IndexedDB access`),await n(),e.Ea.delete(1),await Cs(e)}))}function Ds(e,t){return t().catch((n=>Es(e,n,t)))}async function Os(e){let t=N(e),n=zs(t),r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:dr;for(;ks(t);)try{let e=await $o(t.localStore,r);if(e===null){t.Ta.length===0&&n.L_();break}r=e.batchId,As(t,e)}catch(e){await Es(t,e)}js(t)&&Ms(t)}function ks(e){return Ts(e)&&e.Ta.length<10}function As(e,t){e.Ta.push(t);let n=zs(e);n.O_()&&n.X_&&n.ea(t.mutations)}function js(e){return Ts(e)&&!zs(e).x_()&&e.Ta.length>0}function Ms(e){zs(e).start()}async function Ns(e){zs(e).ra()}async function Ps(e){let t=zs(e);for(let n of e.Ta)t.ea(n.mutations)}async function Fs(e,t,n){let r=e.Ta.shift(),i=Ha.from(r,t,n);await Ds(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Os(e)}async function Is(e,t){t&&zs(e).X_&&await async function(e,t){if(function(e){return Wa(e)&&e!==P.ABORTED}(t.code)){let n=e.Ta.shift();zs(e).B_(),await Ds(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Os(e)}}(e,t),js(e)&&Ms(e)}async function Ls(e,t){let n=N(e);n.asyncQueue.verifyOperationInProgress(),k(xs,`RemoteStore received new credentials`);let r=Ts(n);n.Ea.add(3),await ws(n),r&&n.Ra.set(`Unknown`),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await Cs(n)}async function Rs(e,t){let n=N(e);t?(n.Ea.delete(2),await Cs(n)):t||(n.Ea.add(2),await ws(n),n.Ra.set(`Unknown`))}function zs(e){return e.fa||(e.fa=function(e,t,n){let r=N(e);return r.sa(),new _s(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Ns.bind(null,e),r_:Is.bind(null,e),ta:Ps.bind(null,e),na:Fs.bind(null,e)}),e.da.push((async t=>{t?(e.fa.B_(),await Os(e)):(await e.fa.stop(),e.Ta.length>0&&(k(xs,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))}))),e.fa}var Bs=class e{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new wn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,a){let o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(P.CANCELLED,`Operation cancelled`+(e?`: `+e:``))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle===null?Promise.resolve():(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e))))))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Vs(e,t){if(A(`AsyncQueue`,`${t}: ${e}`),lr(e))return new F(P.UNAVAILABLE,`${t}: ${e}`);throw e}var Hs=class{constructor(){this.queries=Us(),this.onlineState=`Unknown`,this.Ca=new Set}terminate(){(function(e,t){let n=N(e),r=n.queries;n.queries=Us(),r.forEach(((e,n)=>{for(let e of n.Sa)e.onError(t)}))})(this,new F(P.ABORTED,`Firestore shutting down`))}};function Us(){return new Xi((e=>Gi(e)),Wi)}function Ws(e){e.Ca.forEach((e=>{e.next()}))}var Gs,Ks;(Ks=Gs||={}).Ma=`default`,Ks.Cache=`cache`;var qs=`SyncEngine`,Js=class{constructor(e,t,n,r,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Xi((e=>Gi(e)),Wi),this.Iu=new Map,this.Eu=new Set,this.du=new W(z.comparator),this.Au=new Map,this.Ru=new Fo,this.Vu={},this.mu=new Map,this.fu=xo.cr(),this.onlineState=`Unknown`,this.gu=void 0}get isPrimaryClient(){return!0===this.gu}};async function Ys(e,t,n){let r=rc(e);try{let e=await function(e,t){let n=N(e),r=V.now(),i=t.reduce(((e,t)=>e.add(t.key)),J()),a,o;return n.persistence.runTransaction(`Locally write mutations`,`readwrite`,(e=>{let s=Qi(),c=J();return n.Ns.getEntries(e,i).next((e=>{s=e,s.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,s))).next((i=>{a=i;let o=[];for(let e of t){let t=Ma(e,a.get(e.key).overlayedDocument);t!=null&&o.push(new Fa(e.key,t,ci(t.value.mapValue),Ea.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;let r=t.applyToLocalDocumentSet(a,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:ta(a)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||=new W(I),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await tc(r,e.changes),await Os(r.remoteStore)}catch(e){let t=Vs(e,`Failed to persist write`);n.reject(t)}}function Xs(e,t,n){let r=N(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let e=[];r.Tu.forEach(((n,r)=>{let i=r.view.va(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){let n=N(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(let e of n.Sa)e.va(t)&&(r=!0)})),r&&Ws(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Zs(e,t){let n=N(e),r=t.batch.batchId;try{let e=await Zo(n.localStore,t);ec(n,r,null),$s(n,r),n.sharedClientState.updateMutationState(r,`acknowledged`),await tc(n,e)}catch(e){await sr(e)}}async function Qs(e,t,n){let r=N(e);try{let e=await function(e,t){let n=N(e);return n.persistence.runTransaction(`Reject batch`,`readwrite-primary`,(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(M(t!==null,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);ec(r,t,n),$s(r,t),r.sharedClientState.updateMutationState(t,`rejected`,n),await tc(r,e)}catch(e){await sr(e)}}function $s(e,t){(e.mu.get(t)||[]).forEach((e=>{e.resolve()})),e.mu.delete(t)}function ec(e,t,n){let r=N(e),i=r.Vu[r.currentUser.toKey()];if(i){let e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}async function tc(e,t,n){let r=N(e),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((e,s)=>{o.push(r.pu(s,t,n).then((e=>{if((e||n)&&r.isPrimaryClient){let t=e?!e.fromCache:n?.targetChanges.get(s.targetId)?.current;r.sharedClientState.updateQueryState(s.targetId,t?`current`:`not-current`)}if(e){i.push(e);let t=Wo.As(s.targetId,e);a.push(t)}})))})),await Promise.all(o),r.Pu.H_(i),await async function(e,t){let n=N(e);try{await n.persistence.runTransaction(`notifyLocalViewChanges`,`readwrite`,(e=>U.forEach(t,(t=>U.forEach(t.Es,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>U.forEach(t.ds,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!lr(e))throw e;k(qo,`Failed to update sequence numbers: `+e)}for(let e of t){let t=e.targetId;if(!e.fromCache){let e=n.Ms.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(t,i)}}}(r.localStore,a))}async function nc(e,t){let n=N(e);if(!n.currentUser.isEqual(t)){k(qs,`User change. New user:`,t.toKey());let e=await Xo(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach((e=>{e.forEach((e=>{e.reject(new F(P.CANCELLED,t))}))})),e.mu.clear()}(n,`'waitForPendingWrites' promise is rejected due to a user change.`),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await tc(n,e.Ls)}}function rc(e){let t=N(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Zs.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Qs.bind(null,t),t}var ic=class{constructor(){this.kind=`memory`,this.synchronizeTabs=!1}async initialize(e){this.serializer=ps(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Yo(this.persistence,new Ko,e.initialUser,this.serializer)}Cu(e){return new Bo(Ho.mi,this.serializer)}Du(e){return new ts}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};ic.provider={build:()=>new ic};var ac=class extends ic{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){M(this.persistence.referenceDelegate instanceof Uo,46915);let n=this.persistence.referenceDelegate.garbageCollector;return new Eo(n,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes===void 0?bo.DEFAULT:bo.withCacheSize(this.cacheSizeBytes);return new Bo((e=>Uo.mi(e,t)),this.serializer)}},oc=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Xs(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=nc.bind(null,this.syncEngine),await Rs(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Hs}()}createDatastore(e){let t=ps(e.databaseInfo.databaseId),n=function(e){return new ds(e)}(e.databaseInfo);return function(e,t,n,r){return new ys(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Ss(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>Xs(this.syncEngine,e,0)),function(){return is.v()?new is:new ns}())}createSyncEngine(e,t){return function(e,t,n,r,i,a,o){let s=new Js(e,t,n,r,i,a);return o&&(s.gu=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){let t=N(e);k(xs,`RemoteStore shutting down.`),t.Ea.add(5),await ws(t),t.Aa.shutdown(),t.Ra.set(`Unknown`)}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}};oc.provider={build:()=>new oc};var sc=`FirestoreClient`,cc=class{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=D.UNAUTHENTICATED,this.clientId=Pn.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{k(sc,`Received user=`,e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(k(sc,`Received new app check token=`,e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new wn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=Vs(t,`Failed to shutdown persistence`);e.reject(n)}})),e.promise}};async function lc(e,t){e.asyncQueue.verifyOperationInProgress(),k(sc,`Initializing OfflineComponentProvider`);let n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await Xo(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function uc(e,t){e.asyncQueue.verifyOperationInProgress();let n=await dc(e);k(sc,`Initializing OnlineComponentProvider`),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Ls(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Ls(t.remoteStore,n))),e._onlineComponents=t}async function dc(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){k(sc,`Using user provided OfflineComponentProvider`);try{await lc(e,e._uninitializedComponentsProvider._offline)}catch(t){let n=t;if(!function(e){return e.name===`FirebaseError`?e.code===P.FAILED_PRECONDITION||e.code===P.UNIMPLEMENTED:!(typeof DOMException<`u`&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}(n))throw n;xn(`Error using user provided cache. Falling back to memory cache: `+n),await lc(e,new ic)}}else k(sc,`Using default OfflineComponentProvider`),await lc(e,new ac(void 0));return e._offlineComponents}async function fc(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(k(sc,`Using user provided OnlineComponentProvider`),await uc(e,e._uninitializedComponentsProvider._online)):(k(sc,`Using default OnlineComponentProvider`),await uc(e,new oc))),e._onlineComponents}function pc(e){return fc(e).then((e=>e.syncEngine))}function mc(e){let t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}var hc=new Map,gc=`firestore.googleapis.com`,_c=!0,vc=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new F(P.INVALID_ARGUMENT,`Can't provide ssl option if host option is not set`);this.host=gc,this.ssl=_c}else this.host=e.host,this.ssl=e.ssl??_c;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=yo;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Co)throw new F(P.INVALID_ARGUMENT,`cacheSizeBytes must be at least 1048576`);this.cacheSizeBytes=e.cacheSizeBytes}Wn(`experimentalForceLongPolling`,e.experimentalForceLongPolling,`experimentalAutoDetectLongPolling`,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mc(e.experimentalLongPollingOptions??{}),function(e){if(e.timeoutSeconds!==void 0){if(isNaN(e.timeoutSeconds))throw new F(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new F(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new F(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},yc=class{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type=`firestore-lite`,this._persistenceKey=`(lite)`,this._settings=new vc({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask=`notTerminated`}get app(){if(!this._app)throw new F(P.FAILED_PRECONDITION,`Firestore was not initialized using the Firebase SDK. 'app' is not available`);return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==`notTerminated`}_setSettings(e){if(this._settingsFrozen)throw new F(P.FAILED_PRECONDITION,`Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.`);this._settings=new vc(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(e){if(!e)return new En;switch(e.type){case`firstParty`:return new An(e.sessionIndex||`0`,e.iamToken||null,e.authTokenFactory||null);case`provider`:return e.client;default:throw new F(P.INVALID_ARGUMENT,`makeAuthCredentialsProvider failed due to invalid credential type`)}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask===`notTerminated`&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask===`notTerminated`?await this._terminate():this._terminateTask=`notTerminated`}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let t=hc.get(e);t&&(k(`ComponentProvider`,`Removing Datastore`),hc.delete(e),t.terminate())}(this),Promise.resolve()}};function bc(e,t,n,r={}){e=Yn(e,yc);let i=ee(t),a=e._getSettings(),o={...a,emulatorOptions:e._getEmulatorOptions()},s=`${t}:${n}`;i&&(te(`https://${s}`),oe(`Firestore`,!0)),a.host!==gc&&a.host!==s&&xn(`Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.`);let c={...a,host:s,ssl:i,emulatorOptions:r};if(!he(c,o)&&(e._setSettings(c),r.mockUserToken)){let t,n;if(typeof r.mockUserToken==`string`)t=r.mockUserToken,n=D.MOCK_USER;else{t=ne(r.mockUserToken,e._app?.options.projectId);let i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new F(P.INVALID_ARGUMENT,`mockUserToken must contain 'sub' or 'user_id' field!`);n=new D(i)}e._authCredentials=new Dn(new Tn(t,n))}}var xc=class e{constructor(e,t,n){this.converter=t,this._query=n,this.type=`query`,this.firestore=e}withConverter(t){return new e(this.firestore,t,this._query)}},$=class e{constructor(e,t,n){this.converter=t,this._key=n,this.type=`document`,this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sc(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new e(this.firestore,t,this._key)}toJSON(){return{type:e._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(Xn(n,e._jsonSchema))return new e(t,r||null,new z(L.fromString(n.referencePath)))}};$._jsonSchemaVersion=`firestore/documentReference/1.0`,$._jsonSchema={type:B(`string`,$._jsonSchemaVersion),referencePath:B(`string`)};var Sc=class e extends xc{constructor(e,t,n){super(e,t,Li(n)),this._path=n,this.type=`collection`}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new $(this.firestore,null,new z(e))}withConverter(t){return new e(this.firestore,t,this._path)}};function Cc(e,t,...n){if(e=_e(e),Un(`collection`,`path`,t),e instanceof yc){let r=L.fromString(t,...n);return Kn(r),new Sc(e,null,r)}{if(!(e instanceof $||e instanceof Sc))throw new F(P.INVALID_ARGUMENT,`Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore`);let r=e._path.child(L.fromString(t,...n));return Kn(r),new Sc(e.firestore,null,r)}}function wc(e,t,...n){if(e=_e(e),arguments.length===1&&(t=Pn.newId()),Un(`doc`,`path`,t),e instanceof yc){let r=L.fromString(t,...n);return Gn(r),new $(e,null,new z(r))}{if(!(e instanceof $||e instanceof Sc))throw new F(P.INVALID_ARGUMENT,`Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore`);let r=e._path.child(L.fromString(t,...n));return Gn(r),new $(e.firestore,e instanceof Sc?e.converter:null,new z(r))}}var Tc=`AsyncQueue`,Ec=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ms(this,`async_queue_retry`),this._c=()=>{let e=fs();e&&k(Tc,`Visibility state changed to `+e.visibilityState),this.M_.w_()},this.ac=e;let t=fs();t&&typeof t.addEventListener==`function`&&t.addEventListener(`visibilitychange`,this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=fs();t&&typeof t.removeEventListener==`function`&&t.removeEventListener(`visibilitychange`,this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));let t=new wn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!lr(e))throw e;k(Tc,`Operation failed with retryable error: `+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){let t=this.ac.then((()=>(this.rc=!0,e().catch((e=>{throw this.nc=e,this.rc=!1,A(`INTERNAL UNHANDLED ERROR: `,Dc(e)),e})).then((e=>(this.rc=!1,e))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=Bs.createAndSchedule(this,e,t,n,(e=>this.hc(e)));return this.tc.push(r),r}uc(){this.nc&&j(47125,{Pc:Dc(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(let t of this.tc)if(t.skipDelay(),e!==`all`&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function Dc(e){let t=e.message||``;return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}var Oc=class extends yc{constructor(e,t,n,r){super(e,t,n,r),this.type=`firestore`,this._queue=new Ec,this._persistenceKey=r?.name||`[DEFAULT]`}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Ec(e),this._firestoreClient=void 0,await e}}};function kc(e,t){let n=typeof e==`object`?e:Bt(),r=typeof e==`string`?e:t||zr,i=Pt(n,`firestore`).getImmediate({identifier:r});if(!i._initialized){let e=m(`firestore`);e&&bc(i,...e)}return i}function Ac(e){if(e._terminated)throw new F(P.FAILED_PRECONDITION,`The client has already been terminated.`);return e._firestoreClient||jc(e),e._firestoreClient}function jc(e){let t=e._freezeSettings(),n=function(e,t,n,r){return new Rr(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,mc(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,e._app?.options.appId||``,e._persistenceKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new cc(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(e){let t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}(e._componentsProvider))}var Mc=class e{constructor(e){this._byteString=e}static fromBase64String(t){try{return new e(Dr.fromBase64String(t))}catch(e){throw new F(P.INVALID_ARGUMENT,`Failed to construct data from Base64 string: `+e)}}static fromUint8Array(t){return new e(Dr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return`Bytes(base64: `+this.toBase64()+`)`}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:e._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Xn(t,e._jsonSchema))return e.fromBase64String(t.bytes)}};Mc._jsonSchemaVersion=`firestore/bytes/1.0`,Mc._jsonSchema={type:B(`string`,Mc._jsonSchemaVersion),bytes:B(`string`)};var Nc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(P.INVALID_ARGUMENT,`Invalid field name at argument $(i + 1). Field names must not be empty.`);this._internalPath=new R(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}},Pc=class{constructor(e){this._methodName=e}},Fc=class e{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(P.INVALID_ARGUMENT,`Latitude must be a number between -90 and 90, but was: `+e);if(!isFinite(t)||t<-180||t>180)throw new F(P.INVALID_ARGUMENT,`Longitude must be a number between -180 and 180, but was: `+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return I(this._lat,e._lat)||I(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:e._jsonSchemaVersion}}static fromJSON(t){if(Xn(t,e._jsonSchema))return new e(t.latitude,t.longitude)}};Fc._jsonSchemaVersion=`firestore/geoPoint/1.0`,Fc._jsonSchema={type:B(`string`,Fc._jsonSchemaVersion),latitude:B(`number`),longitude:B(`number`)};var Ic=class e{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:e._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Xn(t,e._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e==`number`)))return new e(t.vectorValues);throw new F(P.INVALID_ARGUMENT,`Expected 'vectorValues' field to be a number array`)}}};Ic._jsonSchemaVersion=`firestore/vectorValue/1.0`,Ic._jsonSchema={type:B(`string`,Ic._jsonSchemaVersion),vectorValues:B(`object`)};var Lc=/^__.*__$/,Rc=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask===null?new Pa(e,this.data,t,this.fieldTransforms):new Fa(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function zc(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j(40011,{Ac:e})}}var Bc=class e{constructor(e,t,n,r,i,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new e({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){let t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Zc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc(`Document fields must not be empty`);if(zc(this.Ac)&&Lc.test(e))throw this.Sc(`Document fields cannot begin and end with "__"`)}},Vc=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ps(e)}Cc(e,t,n,r=!1){return new Bc({Ac:e,methodName:t,Dc:n,path:R.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Hc(e){let t=e._freezeSettings(),n=ps(e._databaseId);return new Vc(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Uc(e,t,n,r,i,a={}){let o=e.Cc(a.merge||a.mergeFields?2:0,t,n,i);qc(`Data must be an object, but it was:`,o,r);let s=Gc(r,o),c,l;if(a.merge)c=new Tr(o.fieldMask),l=o.fieldTransforms;else if(a.mergeFields){let e=[];for(let r of a.mergeFields){let i=Jc(t,r,n);if(!o.contains(i))throw new F(P.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Qc(e,i)||e.push(i)}c=new Tr(e),l=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=o.fieldTransforms;return new Rc(new si(s),c,l)}function Wc(e,t){if(Kc(e=_e(e)))return qc(`Unsupported field value:`,t,e),Gc(e,t);if(e instanceof Pc)return function(e,t){if(!zc(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);let n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc(`Nested arrays are not supported`);return function(e,t){let n=[],r=0;for(let i of e){let e=Wc(i,t.wc(r));e??={nullValue:`NULL_VALUE`},n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if((e=_e(e))===null)return{nullValue:`NULL_VALUE`};if(typeof e==`number`)return da(t.serializer,e);if(typeof e==`boolean`)return{booleanValue:e};if(typeof e==`string`)return{stringValue:e};if(e instanceof Date){let n=V.fromDate(e);return{timestampValue:qa(t.serializer,n)}}if(e instanceof V){let n=new V(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:qa(t.serializer,n)}}if(e instanceof Fc)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Mc)return{bytesValue:Ja(t.serializer,e._byteString)};if(e instanceof $){let n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Za(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Ic)return function(e,t){return{mapValue:{fields:{[Vr]:{stringValue:Wr},[Gr]:{arrayValue:{values:e.toArray().map((e=>{if(typeof e!=`number`)throw t.Sc(`VectorValues must only contain numeric values.`);return la(t.serializer,e)}))}}}}}}(e,t);throw t.Sc(`Unsupported field value: ${Jn(e)}`)}(e,t)}function Gc(e,t){let n={};return xr(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):br(e,((e,r)=>{let i=Wc(r,t.mc(e));i!=null&&(n[e]=i)})),{mapValue:{fields:n}}}function Kc(e){return!(typeof e!=`object`||!e||e instanceof Array||e instanceof Date||e instanceof V||e instanceof Fc||e instanceof Mc||e instanceof $||e instanceof Pc||e instanceof Ic)}function qc(e,t,n){if(!Kc(n)||!qn(n)){let r=Jn(n);throw r===`an object`?t.Sc(e+` a custom object`):t.Sc(e+` `+r)}}function Jc(e,t,n){if((t=_e(t))instanceof Nc)return t._internalPath;if(typeof t==`string`)return Xc(e,t);throw Zc(`Field path arguments must be of type string or `,e,!1,void 0,n)}var Yc=RegExp(`[~\\*/\\[\\]]`);function Xc(e,t,n){if(t.search(Yc)>=0)throw Zc(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Nc(...t.split(`.`))._internalPath}catch{throw Zc(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Zc(e,t,n,r,i){let a=r&&!r.isEmpty(),o=i!==void 0,s=`Function ${t}() called with invalid data`;n&&(s+=" (via `toFirestore()`)"),s+=`. `;let c=``;return(a||o)&&(c+=` (found`,a&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=`)`),new F(P.INVALID_ARGUMENT,s+e+c)}function Qc(e,t){return e.some((e=>e.isEqual(t)))}var $c=class{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new $(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new el(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(tl(`DocumentSnapshot.get`,e));if(t!==null)return this._userDataWriter.convertValue(t)}}},el=class extends $c{data(){return super.data()}};function tl(e,t){return typeof t==`string`?Xc(e,t):t instanceof Nc?t._internalPath:t._delegate._internalPath}function nl(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}var rl=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},il=class e extends $c{constructor(e,t,n,r,i,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new al(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(tl(`DocumentSnapshot.get`,e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new F(P.FAILED_PRECONDITION,`DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().`);let t=this._document,n={};return n.type=e._jsonSchemaVersion,n.bundle=``,n.bundleSource=`DocumentSnapshot`,n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,`previous`),n.bundle=(this._firestore,this.ref.path,`NOT SUPPORTED`),n)}};il._jsonSchemaVersion=`firestore/documentSnapshot/1.0`,il._jsonSchema={type:B(`string`,il._jsonSchemaVersion),bundleSource:B(`string`,`DocumentSnapshot`),bundleName:B(`string`),bundle:B(`string`)};var al=class extends il{data(e={}){return super.data(e)}},ol=class e{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new rl(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){let e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new al(this._firestore,this._userDataWriter,n.key,n,new rl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(P.INVALID_ARGUMENT,`To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().`);return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{let r=new al(e._firestore,e._userDataWriter,n.doc.key,n.doc,new rl(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:`added`,doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||e.type!==3)).map((t=>{let r=new al(e._firestore,e._userDataWriter,t.doc.key,t.doc,new rl(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return t.type!==0&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),t.type!==1&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:sl(t.type),doc:r,oldIndex:i,newIndex:a}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new F(P.FAILED_PRECONDITION,`QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().`);let t={};t.type=e._jsonSchemaVersion,t.bundleSource=`QuerySnapshot`,t.bundleName=Pn.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let n=[],r=[],i=[];return this.docs.forEach((e=>{e._document!==null&&(n.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,`previous`)),i.push(e.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,`NOT SUPPORTED`),t}};function sl(e){switch(e){case 0:return`added`;case 2:case 3:return`modified`;case 1:return`removed`;default:return j(61501,{type:e})}}ol._jsonSchemaVersion=`firestore/querySnapshot/1.0`,ol._jsonSchema={type:B(`string`,ol._jsonSchemaVersion),bundleSource:B(`string`,`QuerySnapshot`),bundleName:B(`string`),bundle:B(`string`)};function cl(e,t){let n=Yn(e.firestore,Oc),r=wc(e),i=nl(e.converter,t);return ll(n,[Uc(Hc(e.firestore),`addDoc`,r._key,i,e.converter!==null,{}).toMutation(r._key,Ea.exists(!1))]).then((()=>r))}function ll(e,t){return function(e,t){let n=new wn;return e.asyncQueue.enqueueAndForget((async()=>Ys(await pc(e),t,n))),n.promise}(Ac(e),t)}(function(e,t=!0){(function(e){yn=e})(Rt),Nt(new ve(`firestore`,((e,{instanceIdentifier:n,options:r})=>{let i=e.getProvider(`app`).getImmediate(),a=new Oc(new On(e.getProvider(`auth-internal`)),new Mn(i,e.getProvider(`app-check-internal`)),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,[`projectId`]))throw new F(P.INVALID_ARGUMENT,`"projectId" not provided in firebase.initializeApp.`);return new Br(e.options.projectId,t)}(i,n),i);return r={useFetchStreams:t,...r},a._setSettings(r),a}),`PUBLIC`).setMultipleInstances(!0)),T(_n,vn,e),T(_n,vn,`esm2020`)})();var ul=kc(zt({apiKey:`AIzaSyABqx2NlFH-3YWxDrZNS0hUkxFUkdKwhdc`,authDomain:`aquateamlanding.firebaseapp.com`,projectId:`aquateamlanding`,storageBucket:`aquateamlanding.appspot.com`,messagingSenderId:`26097129232`,appId:`1:26097129232:web:37362a82ee5c29b534b795`}));const dl=async(e,t,n=``)=>{try{return await cl(Cc(ul,`encuesta_compra`),{nombre:t||`Annimo`,interesado:e,motivo_rechazo:n,fecha:new Date,dispositivo:navigator.userAgent}),!0}catch(e){return console.error(`Error guardando voto: `,e),!1}};document.addEventListener(`DOMContentLoaded`,()=>{let e=document.querySelectorAll(`[data-animate], .fade-in-up`);e.forEach(e=>{e.classList.add(`hidden-element`);let t=e.style.getPropertyValue(`--delay`);t&&(e.style.transitionDelay=t)});let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add(`show-element`),e.target.classList.remove(`hidden-element`),t.unobserve(e.target))})},{threshold:.1,rootMargin:`0px 0px -50px 0px`});e.forEach(e=>t.observe(e));let n=document.querySelector(`.navbar`);window.addEventListener(`scroll`,()=>{window.scrollY>20?(n.style.boxShadow=`0 4px 20px rgba(0,0,0,0.05)`,n.style.background=`rgba(255, 255, 255, 0.95)`):(n.style.boxShadow=`none`,n.style.background=`rgba(255, 255, 255, 0.85)`)});let r=document.querySelector(`.hamburger`),i=document.querySelector(`.nav-links`);r&&r.addEventListener(`click`,()=>{i.style.display!==`flex`&&window.innerWidth<768?(i.style.display=`flex`,i.style.flexDirection=`column`,i.style.position=`absolute`,i.style.top=`60px`,i.style.right=`5%`,i.style.background=`white`,i.style.padding=`2rem`,i.style.boxShadow=`0 10px 30px rgba(0,0,0,0.1)`,i.style.borderRadius=`10px`):i.style.display=``});let a=document.getElementById(`btn-yes`),o=document.getElementById(`btn-no`),s=document.getElementById(`user-name`),c=document.getElementById(`user-reason`),l=document.getElementById(`reason-container`),u=document.getElementById(`poll-form`),d=document.getElementById(`poll-loading`),f=document.getElementById(`poll-thanks`),p=document.getElementById(`poll-error`),m=document.getElementById(`thanks-name`),h=!1,g=async e=>{let t=s.value.trim()||`Annimo`,n=c.value.trim();if(e===`NO`&&!h){h=!0,a.style.display=`none`,l.style.display=`flex`,l.classList.remove(`hidden-element`),l.classList.add(`show-element`),o.innerHTML=`Enviar Opinin `,c.focus();return}u.style.display=`none`,d.style.display=`block`,p.style.display=`none`;let r=await dl(e,t,n);d.style.display=`none`,r?(t!==`Annimo`&&(m.textContent=t),f.style.display=`block`,setTimeout(()=>{f.classList.remove(`hidden-element`),f.classList.add(`show-element`)},10)):(p.style.display=`block`,u.style.display=`block`)};a&&o&&(a.addEventListener(`click`,()=>g(`SI`)),o.addEventListener(`click`,()=>g(`NO`)))});